[package]
name = "tbui17/mysite"
version = "0.1.0"
description = "WordPress site on Wasmer"
entrypoint = "run"

[dependencies]
"php/php-eh" = "=8.3.404-beta.4"
"wasmer/bash" = "*"

[fs]
# Maps your local 'app' folder (which contains 'public') to the container
"/app" = "app"
"/conf" = "conf" 

[[command]]
name = "run"
module = "php/php-eh:php"
runner = "wcgi" # Changed to wcgi for better Edge support

[command.annotations.wcgi]
# This points to where index.php lives
root = "app/public" 

[[command]]
name = "wp-cron"
module = "php/php-eh:php"
runner = "wasi"
[command.annotations.wasi]
main-args = [
    "/app/public/wp-cron.php", # Updated path to find the file
    "--path=/app/public",
]

# Keep your install command if you have that script
[[command]]
name = "install-wp"
module = "wasmer/bash:bash"
runner = "wasi"
[command.annotations.wasi]
main-args = ["/app/public/install/install.sh"]