!function(){var e={53316:function(e){function t(e,t,n,r){var o,i=null==(o=r)||"number"==typeof o||"boolean"==typeof o?r:n(r),a=t.get(i);return void 0===a&&(a=e.call(this,r),t.set(i,a)),a}function n(e,t,n){var r=Array.prototype.slice.call(arguments,3),o=n(r),i=t.get(o);return void 0===i&&(i=e.apply(this,r),t.set(o,i)),i}function r(e,t,n,r,o){return n.bind(t,e,r,o)}function o(e,o){return r(e,this,1===e.length?t:n,o.cache.create(),o.serializer)}function i(){return JSON.stringify(arguments)}function a(){this.cache=Object.create(null)}a.prototype.has=function(e){return e in this.cache},a.prototype.get=function(e){return this.cache[e]},a.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new a}};e.exports=function(e,t){var n=t&&t.cache?t.cache:l,r=t&&t.serializer?t.serializer:i;return(t&&t.strategy?t.strategy:o)(e,{cache:n,serializer:r})},e.exports.strategies={variadic:function(e,t){return r(e,this,n,t.cache.create(),t.serializer)},monadic:function(e,n){return r(e,this,t,n.cache.create(),n.serializer)}}},33042:function(e,t,n){var r;!function(){"use strict";var o=function e(t){var n,r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element"),o={use_static:!1};function i(e){var t=Object.getPrototypeOf(e);return t?Object.create(t):{}}function a(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1,value:n})}function l(e,t){a(e,t,(function(){throw new I("The "+t+" method cannot be invoked on an Immutable data structure.")}))}"object"!=typeof(n=t)||Array.isArray(n)||null===n||void 0!==t.use_static&&(o.use_static=Boolean(t.use_static));var s="__immutable_invariants_hold";function u(e){return"object"!=typeof e||(null===e||Boolean(Object.getOwnPropertyDescriptor(e,s)))}function d(e,t){return e===t||e!=e&&t!=t}function c(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}var p=["setPrototypeOf"],m=p.concat(["push","pop","sort","splice","shift","unshift","reverse"]),g=["keys"].concat(["map","filter","slice","concat","reduce","reduceRight"]),f=p.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);function I(e){this.name="MyError",this.message=e,this.stack=(new Error).stack}function y(e,t){for(var n in a(e,s,!0),t)t.hasOwnProperty(n)&&l(e,t[n]);return Object.freeze(e),e}function E(e,t){var n=e[t];a(e,t,(function(){return H(n.apply(e,arguments))}))}function _(e,t,n){var r=n&&n.deep;if(e in this&&(r&&this[e]!==t&&c(t)&&c(this[e])&&(t=H.merge(this[e],t,{deep:!0,mode:"replace"})),d(this[e],t)))return this;var o=T.call(this);return o[e]=H(t),b(o)}I.prototype=new Error,I.prototype.constructor=Error;var h=H([]);function M(e,t,n){var r=e[0];if(1===e.length)return _.call(this,r,t,n);var o,i=e.slice(1),a=this[r];if("object"==typeof a&&null!==a)o=H.setIn(a,i,t);else{var l=i[0];o=""!==l&&isFinite(l)?M.call(h,i,t):w.call(k,i,t)}if(r in this&&a===o)return this;var s=T.call(this);return s[r]=o,b(s)}function b(e){for(var t in g){if(g.hasOwnProperty(t))E(e,g[t])}o.use_static||(a(e,"flatMap",O),a(e,"asObject",C),a(e,"asMutable",T),a(e,"set",_),a(e,"setIn",M),a(e,"update",V),a(e,"updateIn",x),a(e,"getIn",B));for(var n=0,r=e.length;n<r;n++)e[n]=H(e[n]);return y(e,m)}function v(){return new Date(this.getTime())}function O(e){if(0===arguments.length)return this;var t,n=[],r=this.length;for(t=0;t<r;t++){var o=e(this[t],t,this);Array.isArray(o)?n.push.apply(n,o):n.push(o)}return b(n)}function A(e){if(void 0===e&&0===arguments.length)return this;if("function"!=typeof e){var t=Array.isArray(e)?e.slice():Array.prototype.slice.call(arguments);t.forEach((function(e,t,n){"number"==typeof e&&(n[t]=e.toString())})),e=function(e,n){return-1!==t.indexOf(n)}}var n=i(this);for(var r in this)this.hasOwnProperty(r)&&!1===e(this[r],r)&&(n[r]=this[r]);return $(n)}function T(e){var t,n,r=[];if(e&&e.deep)for(t=0,n=this.length;t<n;t++)r.push(L(this[t]));else for(t=0,n=this.length;t<n;t++)r.push(this[t]);return r}function C(e){"function"!=typeof e&&(e=function(e){return e});var t,n={},r=this.length;for(t=0;t<r;t++){var o=e(this[t],t,this),i=o[0],a=o[1];n[i]=a}return $(n)}function L(e){return!e||"object"!=typeof e||!Object.getOwnPropertyDescriptor(e,s)||e instanceof Date?e:H.asMutable(e,{deep:!0})}function D(e,t){for(var n in e)Object.getOwnPropertyDescriptor(e,n)&&(t[n]=e[n]);return t}function S(e,t){if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(e));var n,r,o=Array.isArray(e),a=t&&t.deep,l=t&&t.mode||"merge",s=t&&t.merger;function u(e,r,o){var l,u=H(r[o]),p=s&&s(e[o],u,t),m=e[o];void 0===n&&void 0===p&&e.hasOwnProperty(o)&&d(u,m)||(d(m,l=void 0!==p?p:a&&c(m)&&c(u)?H.merge(m,u,t):u)&&e.hasOwnProperty(o)||(void 0===n&&(n=D(e,i(e))),n[o]=l))}function p(e,t){for(var r in e)t.hasOwnProperty(r)||(void 0===n&&(n=D(e,i(e))),delete n[r])}if(o)for(var m=0,g=e.length;m<g;m++){var f=e[m];for(r in f)f.hasOwnProperty(r)&&u(void 0!==n?n:this,f,r)}else{for(r in e)Object.getOwnPropertyDescriptor(e,r)&&u(this,e,r);"replace"===l&&p(this,e)}return void 0===n?this:$(n)}function R(e,t){var n=t&&t.deep;if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(e));return H.merge(this,e,{deep:n,mode:"replace"})}var P,U,N,k=H({});function w(e,t,n){if(!Array.isArray(e)||0===e.length)throw new TypeError('The first argument to Immutable#setIn must be an array containing at least one "key" string.');var r=e[0];if(1===e.length)return G.call(this,r,t,n);var o,a=e.slice(1),l=this[r];if(o=this.hasOwnProperty(r)&&"object"==typeof l&&null!==l?H.setIn(l,a,t):w.call(k,a,t),this.hasOwnProperty(r)&&l===o)return this;var s=D(this,i(this));return s[r]=o,$(s)}function G(e,t,n){var r=n&&n.deep;if(this.hasOwnProperty(e)&&(r&&this[e]!==t&&c(t)&&c(this[e])&&(t=H.merge(this[e],t,{deep:!0,mode:"replace"})),d(this[e],t)))return this;var o=D(this,i(this));return o[e]=H(t),$(o)}function V(e,t){var n=Array.prototype.slice.call(arguments,2),r=this[e];return H.set(this,e,t.apply(r,[r].concat(n)))}function F(e,t){for(var n=0,r=t.length;null!=e&&n<r;n++)e=e[t[n]];return n&&n==r?e:void 0}function x(e,t){var n=Array.prototype.slice.call(arguments,2),r=F(this,e);return H.setIn(this,e,t.apply(r,[r].concat(n)))}function B(e,t){var n=F(this,e);return void 0===n?t:n}function j(e){var t,n=i(this);if(e&&e.deep)for(t in this)this.hasOwnProperty(t)&&(n[t]=L(this[t]));else for(t in this)this.hasOwnProperty(t)&&(n[t]=this[t]);return n}function Y(){return{}}function $(e){return o.use_static||(a(e,"merge",S),a(e,"replace",R),a(e,"without",A),a(e,"asMutable",j),a(e,"set",G),a(e,"setIn",w),a(e,"update",V),a(e,"updateIn",x),a(e,"getIn",B)),y(e,p)}function H(e,t,n){if(u(e)||function(e){return"object"==typeof e&&null!==e&&(60103===e.$$typeof||e.$$typeof===r)}(e)||function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)||function(e){return e instanceof Error}(e))return e;if(function(e){return"object"==typeof e&&"function"==typeof e.then}(e))return e.then(H);if(Array.isArray(e))return b(e.slice());if(e instanceof Date)return i=new Date(e.getTime()),o.use_static||a(i,"asMutable",v),y(i,f);var i,l=t&&t.prototype,s=(l&&l!==Object.prototype?function(){return Object.create(l)}:Y)();if(null==n&&(n=64),n<=0)throw new I("Attempt to construct Immutable from a deeply nested object was detected. Have you tried to wrap an object with circular references (e.g. React element)? See https://github.com/rtfeldman/seamless-immutable/wiki/Deeply-nested-object-was-detected for details.");for(var d in n-=1,e)Object.getOwnPropertyDescriptor(e,d)&&(s[d]=H(e[d],void 0,n));return $(s)}function z(e){return function(){var t=[].slice.call(arguments),n=t.shift();return e.apply(n,t)}}function W(e,t){return function(){var n=[].slice.call(arguments),r=n.shift();return Array.isArray(r)?t.apply(r,n):e.apply(r,n)}}return H.from=H,H.isImmutable=u,H.ImmutableError=I,H.merge=z(S),H.replace=z(R),H.without=z(A),H.asMutable=(P=j,U=T,N=v,function(){var e=[].slice.call(arguments),t=e.shift();return Array.isArray(t)?U.apply(t,e):t instanceof Date?N.apply(t,e):P.apply(t,e)}),H.set=W(G,_),H.setIn=W(w,M),H.update=z(V),H.updateIn=z(x),H.getIn=z(B),H.flatMap=z(O),H.asObject=z(C),o.use_static||(H.static=e({use_static:!0})),Object.freeze(H),H}();void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};!function(){"use strict";n.r(r),n.d(r,{__DEPRECATED__getModulesByIds:function(){return _n},addColumnViaDivider:function(){return re},addFlexColumnViaDivider:function(){return oe},addGlobalParentToChildren:function(){return c},addGrid:function(){return ae},addGroupPresetToStack:function(){return ke},addModule:function(){return le},addModuleGroup:function(){return se},addModulePresetToStack:function(){return Pe},addRow:function(){return ue},addSpecialtySection:function(){return de},changeColumnStructure:function(){return ce},changeColumnStructureForDragAndDrop:function(){return Ie},changeFlexColumnStructure:function(){return pe},changeFlexColumnStructureForDragAndDrop:function(){return ye},changeGridColumnStructure:function(){return me},changePricingTablesFlexColumnStructure:function(){return fe},clearLayout:function(){return Ee},clearMemoizedFilterModulesByIds:function(){return j},clearRemovedModules:function(){return _e},cloneColumn:function(){return he},cloneFlexColumn:function(){return Me},cloneModule:function(){return be},conditionalDebouncedHistoryUpdate:function(){return Ut},convertSelectedModulesToGroup:function(){return ie},copyModule:function(){return ve},copyModuleFromLibrary:function(){return Oe},copyModuleFromPayload:function(){return Ae},copyModulesFromPayload:function(){return Te},createMemoizeFunction:function(){return V},detectImportedGlobalModules:function(){return W},disableGlobalModule:function(){return Ce},editChildren:function(){return Le},editGroupPresetAttr:function(){return ct},editLocalAttrsMap:function(){return De},editLocalChildren:function(){return Se},editModuleAttribute:function(){return Re},editModuleProp:function(){return Ve},effects:function(){return Gt},extractInlineFontFamilies:function(){return z},filterModulesByIds:function(){return F},findModuleByInteractionTarget:function(){return Jn},getAncestorModules:function(){return an},getAvailableLoopOptions:function(){return sn},getChildModules:function(){return Gn},getClonedModules:function(){return N},getCloudLayoutMetadata:function(){return wn},getContent:function(){return un},getDescendantModulesByType:function(){return Vn},getGlobalLayoutId:function(){return dn},getGlobalLayoutOwners:function(){return cn},getGroupPresetAttr:function(){return Fn},getInsertableContent:function(){return k},getModule:function(){return pn},getModuleAttr:function(){return gn},getModuleAttrs:function(){return fn},getModuleCssVariables:function(){return Kn},getModuleLoopData:function(){return qn},getModuleModifiedAttrs:function(){return In},getModuleName:function(){return yn},getModuleStructureIds:function(){return hn},getModuleType:function(){return Mn},getModuleWithChildren:function(){return bn},getModulesByIds:function(){return En},getNestedGroupPresetIds:function(){return Bn},getParentLayoutType:function(){return er},getParentModule:function(){return on},getParentModuleId:function(){return vn},getParentModuleType:function(){return On},getRootModuleIds:function(){return An},getSelectedModulePreset:function(){return Yn},getSelectedOptionGroupPreset:function(){return Hn},getSiblingModuleIds:function(){return Tn},getSpecialtySectionStatus:function(){return Cn},getUsedPresets:function(){return Ln},hasAncestorColumnType:function(){return Wn},hasResponsiveValues:function(){return Sn},hasStickyState:function(){return Rn},importContent:function(){return Fe},insertIdIntoIdList:function(){return p},isChildrenOfLocalChildrenGlobalModuleInstance:function(){return Zn},isCloneable:function(){return U},isContentEmpty:function(){return Un},isDisabled:function(){return Pn},isNestedModule:function(){return zn},isSectionOrInsideSection:function(){return Nn},isStickyStateActive:function(){return kn},longerDebouncedAddHistoryLayoutItem:function(){return Pt},memoizedFilterModulesByIds:function(){return B},mergeGlobalModules:function(){return xe},moveModule:function(){return Be},moveModules:function(){return je},parseSerializedPostIntoFlatModuleObject:function(){return H},performFindReplace:function(){return ze},processImportedGlobalModules:function(){return K},quickDebouncedAddHistoryLayoutItem:function(){return Rt},quickDebouncedMaybeRegenerateCarouselClones:function(){return kt},quickDebouncedMaybeUpdateUsedPresets:function(){return Nt},registerEditPostStore:function(){return ir},removeColumn:function(){return We},removeGlobalModuleAttribute:function(){return Ke},removeGlobalParentAttribute:function(){return Xe},removeGroupPresetAttribute:function(){return Je},removeGroupPresetFromStack:function(){return we},removeModule:function(){return qe},removeModuleAttribute:function(){return Qe},removeModuleAttributes:function(){return Ze},removeModulePresetFromStack:function(){return Ue},removeModuleStateProperties:function(){return et},replaceGroupPresetInStack:function(){return Ge},replaceModuleAttributes:function(){return tt},replaceModulePresetInStack:function(){return Ne},resetFlexColumnStructure:function(){return ge},revertGlobalModuleEditState:function(){return nt},setGlobalModuleAttribute:function(){return rt},setGlobalParentAttribute:function(){return ot},setLayoutState:function(){return it},setModuleLoopData:function(){return pt},setSpecialtySectionStatus:function(){return at},shouldSynchronizeToGlobalModuleTemplate:function(){return Qn},smartMaybeUpdateUsedPresets:function(){return wt},syncGlobalLayoutAttributes:function(){return lt},syncModuleGlobalColors:function(){return st},syncModuleInlineFont:function(){return ut},updateUsedPresets:function(){return dt}});var e={};n.r(e),n.d(e,{addColumnViaDivider:function(){return re},addFlexColumnViaDivider:function(){return oe},addGrid:function(){return ae},addGroupPresetToStack:function(){return ke},addModule:function(){return le},addModuleGroup:function(){return se},addModulePresetToStack:function(){return Pe},addRow:function(){return ue},addSpecialtySection:function(){return de},changeColumnStructure:function(){return ce},changeColumnStructureForDragAndDrop:function(){return Ie},changeFlexColumnStructure:function(){return pe},changeFlexColumnStructureForDragAndDrop:function(){return ye},changeGridColumnStructure:function(){return me},changePricingTablesFlexColumnStructure:function(){return fe},clearLayout:function(){return Ee},clearRemovedModules:function(){return _e},cloneColumn:function(){return he},cloneFlexColumn:function(){return Me},cloneModule:function(){return be},convertSelectedModulesToGroup:function(){return ie},copyModule:function(){return ve},copyModuleFromLibrary:function(){return Oe},copyModuleFromPayload:function(){return Ae},copyModulesFromPayload:function(){return Te},disableGlobalModule:function(){return Ce},editChildren:function(){return Le},editGroupPresetAttr:function(){return ct},editLocalAttrsMap:function(){return De},editLocalChildren:function(){return Se},editModuleAttribute:function(){return Re},editModuleProp:function(){return Ve},importContent:function(){return Fe},mergeGlobalModules:function(){return xe},moveModule:function(){return Be},moveModules:function(){return je},performFindReplace:function(){return ze},removeColumn:function(){return We},removeGlobalModuleAttribute:function(){return Ke},removeGlobalParentAttribute:function(){return Xe},removeGroupPresetAttribute:function(){return Je},removeGroupPresetFromStack:function(){return we},removeModule:function(){return qe},removeModuleAttribute:function(){return Qe},removeModuleAttributes:function(){return Ze},removeModulePresetFromStack:function(){return Ue},removeModuleStateProperties:function(){return et},replaceGroupPresetInStack:function(){return Ge},replaceModuleAttributes:function(){return tt},replaceModulePresetInStack:function(){return Ne},resetFlexColumnStructure:function(){return ge},revertGlobalModuleEditState:function(){return nt},setGlobalModuleAttribute:function(){return rt},setGlobalParentAttribute:function(){return ot},setLayoutState:function(){return it},setModuleLoopData:function(){return pt},setSpecialtySectionStatus:function(){return at},syncGlobalLayoutAttributes:function(){return lt},syncModuleGlobalColors:function(){return st},syncModuleInlineFont:function(){return ut},updateUsedPresets:function(){return dt}});var t={};n.r(t),n.d(t,{__DEPRECATED__getModulesByIds:function(){return _n},findModuleByInteractionTarget:function(){return Jn},getAncestorModules:function(){return an},getAvailableLoopOptions:function(){return sn},getChildModules:function(){return Gn},getCloudLayoutMetadata:function(){return wn},getContent:function(){return un},getDescendantModulesByType:function(){return Vn},getGlobalLayoutId:function(){return dn},getGlobalLayoutOwners:function(){return cn},getGroupPresetAttr:function(){return Fn},getModule:function(){return pn},getModuleAttr:function(){return gn},getModuleAttrs:function(){return fn},getModuleCssVariables:function(){return Kn},getModuleLoopData:function(){return qn},getModuleModifiedAttrs:function(){return In},getModuleName:function(){return yn},getModuleStructureIds:function(){return hn},getModuleType:function(){return Mn},getModuleWithChildren:function(){return bn},getModulesByIds:function(){return En},getNestedGroupPresetIds:function(){return Bn},getParentLayoutType:function(){return er},getParentModule:function(){return on},getParentModuleId:function(){return vn},getParentModuleType:function(){return On},getRootModuleIds:function(){return An},getSelectedModulePreset:function(){return Yn},getSelectedOptionGroupPreset:function(){return Hn},getSiblingModuleIds:function(){return Tn},getSpecialtySectionStatus:function(){return Cn},getUsedPresets:function(){return Ln},hasAncestorColumnType:function(){return Wn},hasResponsiveValues:function(){return Sn},hasStickyState:function(){return Rn},isChildrenOfLocalChildrenGlobalModuleInstance:function(){return Zn},isCloneable:function(){return U},isContentEmpty:function(){return Un},isDisabled:function(){return Pn},isNestedModule:function(){return zn},isSectionOrInsideSection:function(){return Nn},isStickyStateActive:function(){return kn},shouldSynchronizeToGlobalModuleTemplate:function(){return Qn}});var o=n(33042),i=n.n(o),a=window.divi.data,l=window.divi.history,s=window.divi.middleware,u=window.divi.module,d=window.divi.moduleLibrary;const c=(e,t,n)=>{let r=e;const o=r.getIn([t,"children"]);return o&&Array.isArray(o.asMutable())&&o.length>0&&o.forEach((e=>{r=r.setIn([e,"props","attrs","globalParent"],n),r=c(r,e,n)})),r},p=(e,t,n,r="after")=>{const o=[...n],i="after"===r?n.indexOf(t)+1:n.indexOf(t);return o.splice(i,0,e),o};var m,g=window.lodash,f=new Uint8Array(16);function I(){if(!m&&!(m="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(f)}var y=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var E=function(e){return"string"==typeof e&&y.test(e)},_=[],h=0;h<256;++h)_.push((h+256).toString(16).substr(1));var M=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(_[e[t+0]]+_[e[t+1]]+_[e[t+2]]+_[e[t+3]]+"-"+_[e[t+4]]+_[e[t+5]]+"-"+_[e[t+6]]+_[e[t+7]]+"-"+_[e[t+8]]+_[e[t+9]]+"-"+_[e[t+10]]+_[e[t+11]]+_[e[t+12]]+_[e[t+13]]+_[e[t+14]]+_[e[t+15]]).toLowerCase();if(!E(n))throw TypeError("Stringified UUID is invalid");return n};var b=function(e,t,n){var r=(e=e||{}).random||(e.rng||I)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return M(r)},v=window.vendor.wp.hooks;function O(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}var A=e=>Array.isArray(e)?e:[e];function T(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const n=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function C(e,t){const n=[],{length:r}=e;for(let o=0;o<r;o++)n.push(e[o].apply(null,t));return n}Symbol(),Object.getPrototypeOf({});var L="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function D(e,t={}){let n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let o,i=0;function a(){let t=n;const{length:a}=arguments;for(let e=0,n=a;e<n;e++){const n=arguments[e];if("function"==typeof n||"object"==typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t={s:0,v:void 0,o:null,p:null},e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t={s:0,v:void 0,o:null,p:null},e.set(n,t)):t=r}}const l=t;let s;if(1===t.s?s=t.v:(s=e.apply(null,arguments),i++),l.s=1,r){const e=o?.deref?.()??o;null!=e&&r(e,s)&&(s=e,0!==i&&i--);o="object"==typeof s&&null!==s||"function"==typeof s?new L(s):s}return l.v=s,s}return a.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},a.resetResultsCount()},a.resultsCount=()=>i,a.resetResultsCount=()=>{i=0},a}function S(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t,r=0,o=0,i={},a=e.pop();"object"==typeof a&&(i=a,a=e.pop()),O(a,`createSelector expects an output function after the inputs, but received: [${typeof a}]`);const l={...n,...i},{memoize:s,memoizeOptions:u=[],argsMemoize:d=D,argsMemoizeOptions:c=[],devModeChecks:p={}}=l,m=A(u),g=A(c),f=T(e),I=s((function(){return r++,a.apply(null,arguments)}),...m);const y=d((function(){o++;const e=C(f,arguments);return t=I.apply(null,e),t}),...g);return Object.assign(y,{resultFunc:a,memoizedResultFunc:I,dependencies:f,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>t,recomputations:()=>r,resetRecomputations:()=>{r=0},memoize:s,argsMemoize:d})};return Object.assign(r,{withTypes:()=>r}),r}var R=S(D),P=Object.assign(((e,t=R)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e);return t(n.map((t=>e[t])),((...e)=>e.reduce(((e,t,r)=>(e[n[r]]=t,e)),{})))}),{withTypes:()=>P});const U=R([(e,t)=>t.moduleAppearance,(e,t)=>t.themeBuilderLayout,(e,t)=>{const{moduleAppearance:n,moduleName:r,themeBuilderLayout:o}=t,a=t?.moduleCount??i()({});let l=0;return t.moduleAppearance&&(l+=a.getIn([r,o]),"multipleAliases"in n&&(0,g.forEach)(n.multipleAliases,(e=>{l+=a.getIn([e,o])??0}))),l}],((e,t,n)=>{if(Boolean(e)){if("themeBuilderLayouts"in e&&!(0,g.includes)(e.themeBuilderLayouts,t))return!1;if("multiple"in e){if(!0===e.multiple)return!0;if(n>=("number"==typeof e.multiple?e.multiple:1))return!1}}return!0})),N=(e,t)=>{const{moduleId:n,targetParentId:r="",moduleAppearanceSettings:o={},themeBuilderLayout:a="postContent",moduleCount:l}=t,s=e.getIn(["content"]),u=r||s.getIn([n,"parent"]);let d,c=i()({});const p=(t,n)=>{(0,g.isEmpty)(t)||(0,g.forEach)(t,(t=>{const r=s.getIn([t]);if(!r)return;const i=b(),m=(0,v.applyFilters)("divi.cloneModule.attrs",r.asMutable({deep:!0})?.props?.attrs,{state:s.asMutable({deep:!0}),name:r?.name,id:i,parentId:u,sourceId:t}),f=o[r?.name];if(!U(e,{moduleName:r?.name,moduleAppearance:f,themeBuilderLayout:a,moduleCount:l}))return;const I={children:[],id:i,name:r?.name,parent:n,props:(0,g.isEmpty)(m)?r?.props:{...r?.props,attrs:m}};c=c.setIn([i],I);const y=c.getIn([n,"children","length"]);(0,g.isNumber)(y)?c=c.setIn([n,"children",`${y}`],i):d=i;const E=r.asMutable({deep:!0})?.children??[];p(E,i)}))};p([n],u);const m=s.getIn([u,"children"],i()([])),f=(0,g.findIndex)(m.asMutable(),(e=>e===n)),I=(0,g.slice)(m,0,f+1),y=(0,g.slice)(m,f+1);return{clonedModuleId:d,clonedParent:u,clonedParentChildren:[].concat(I,[d],y),clonedModules:c}},k=e=>{const t=(0,a.select)("divi/cloud-app").getUseCloudModuleType();return t.isAddRow?e.replace(/wp:divi\/row-inner /g,"wp:divi/row ").replace(/wp:divi\/column-inner /g,"wp:divi/column "):t.isAddRowInner?e.replace(/wp:divi\/row /g,"wp:divi/row-inner ").replace(/wp:divi\/column /g,"wp:divi/column-inner "):e};var w=n(53316),G=n.n(w);const V=e=>{const t=new Map;return{memoizeFunctionStore:t,memoized:G()(e,{cache:{create:()=>({has:e=>t.has(e),get:e=>t.get(e),set(e,n){t.set(e,n)}})},strategy:G().strategies.variadic}),clear:()=>t.clear()}},F=(e,t,n)=>{const r=i().asMutable(t,{deep:!0}),o=(0,g.pickBy)(r,(t=>(0,g.includes)(e,t.id)));return n?o:i()(o)},x=V(F),B=x.memoized,j=x.clear;var Y=window.vendor.wp.blockSerializationDefaultParser,$=window.vendor.wp.blocks;const H=(e,t,n=b)=>{const r=t||{children:[],name:"divi/root",id:"root",props:{attrs:{}}},o={[r.id]:{...r}},i=(e,t)=>{if(!e.blockName)return;if("divi/modules-styles"===e.blockName)return;if("divi/placeholder"===e.blockName)return void((0,g.isFunction)((0,g.get)(e,"innerBlocks.map"))&&(0,g.forEach)(e.innerBlocks,(e=>i(e,t))));const r=e?.blockName,a=e?.attrs??{},l=!(0,$.getBlockType)(r)||"divi/shortcode-module"===r,s=l?e?.innerHTML:null,u=n(),d={name:r,props:{attrs:a},id:u,parent:t,children:[]};l&&(d.props.innerHTML=s),o[u]=d,o[t].children.push(u),(0,g.isFunction)((0,g.get)(e,"innerBlocks.map"))&&(0,g.forEach)(e.innerBlocks,(e=>i(e,u)))},a=(0,Y.parse)(e);return(0,g.forEach)(a,(e=>{i(e,r.id)})),o},z=e=>{if(!(0,g.isString)(e)||(0,g.isEmpty)(e))return[];const t=[],n=[(new DOMParser).parseFromString(e,"text/html").body];for(;n.length>0;){const e=n.pop(),{fontFamily:r}=e.style;if(r){const e=r.split(",").map((e=>e.trim().replace(/['"]/g,"")));t.push(...e)}n.push(...Array.from(e.children))}return(0,g.uniq)(t)},W=e=>{const t=[];return Object.keys(e).forEach((n=>{if("root"===n)return;const r=(0,g.get)(e,[n,"props","attrs","globalModule"]);r&&"string"==typeof r&&t.push({moduleId:n,globalModuleId:r})})),t},K=(e,t)=>{const n={...e};return t.forEach((({moduleId:e})=>{if(n[e]?.props?.attrs){delete n[e].props.attrs.globalModule,"localAttrsMap"in n[e].props.attrs&&delete n[e].props.attrs.localAttrsMap,"localChildren"in n[e].props.attrs&&delete n[e].props.attrs.localChildren;const t=e=>{(0,g.get)(n,[e,"children"],[]).forEach((e=>{n[e]?.props?.attrs?.globalParent&&delete n[e].props.attrs.globalParent,t(e)}))};t(e)}})),n},X=e=>{const{id:t,position:n,contentState:r}=e,o=r.getIn([t,"children"]);return o?.["first"===n?0:o.length-1]||""},q=e=>{const{action:t,contentState:n}=e,{id:r,position:o}=t,i={},a=n.getIn([r])?.parent,l="inside"===o?r:a;if("string"!=typeof l)return i;const s=n.getIn([l])?.children??[];let u="";switch(o){case"before":u=s?.[s?.indexOf(r)-1];break;case"after":u=s?.[s?.indexOf(r)+1];break;case"inside":u=s?.[s?.length-1]}if(!u)return i;const d=n.getIn([u,"name"]);return(n.getIn([u,"children"])??[]).forEach((e=>{const t=n.getIn([e])?.name;t&&(i[t]||(i[t]={moduleName:t,count:0}),i[t].count+=1)})),i[d]={moduleName:d,count:1},i},J=e=>{const{contentState:t}=e,n={};return(0,g.forEach)(t,(e=>{(0,g.isObject)(e)&&"divi/root"!==e?.name&&"divi/placeholder"!==e?.name&&"divi/global-layout"!==e?.name&&(n[e.name]||(n[e.name]={moduleName:e.name,count:0}),n[e.name].count++)})),n};var Q=window.divi.moduleUtils;const Z=e=>{const{id:t,contentState:n}=e,r={},o=(0,Q.populateContentTree)({tree:n,rootId:t});return(0,g.forEach)(o,(e=>{(0,g.isObject)(e)&&"divi/root"!==e?.name&&"divi/placeholder"!==e?.name&&(r[e.name]||(r[e.name]={moduleName:e.name,count:0}),r[e.name].count++)})),r},ee=e=>{const{id:t,position:n,contentState:r}=e,o=r.getIn([t,"parent"]),i=r.getIn([o]);if(!i||!(0,g.isObject)(i))return"";const a=i?.children,l=a.indexOf(t),s=a?.["after"===n?l+1:l-1];return s||""},te={content:"postContent",header:"header",body:"body",footer:"footer"},ne=(e,t)=>{const n=(0,a.select)("divi/settings").getSetting(["themeBuilder","layout"],"postContent"),r=t.getState();switch(e.type){case"ADD_COLUMN_VIA_DIVIDER":{const t=X({id:e?.id,position:"first",contentState:r.getIn(["content"])}),o=r.getIn(["content",t,"name"],"divi/column");(0,a.dispatch)("divi/module").increaseModuleCount({moduleName:o,layout:n});break}case"CONVERT_SELECTED_MODULES_TO_GROUP":(0,a.dispatch)("divi/module").increaseModuleCount({moduleName:"divi/group",layout:n});break;case"ADD_MODULE":(0,a.dispatch)("divi/module").increaseModuleCount({moduleName:e.name,layout:n});break;case"ADD_ROW":case"ADD_SPECIALTY_SECTION":(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:"increase",modules:q({action:e,contentState:r.getIn(["content"])})});break;case"CHANGE_COLUMN_STRUCTURE":{const{isStructureSame:t,operation:o,moduleCount:i}=(e=>{const{contentState:t,originStructure:n,targetStructure:r,id:o}=e,i=n.split(","),a=r.split(","),l=0==i.length-a.length;if(l)return{isStructureSame:l,operation:"increase",moduleCount:{}};const s=i.length<a.length?"increase":"decrease",u=Math.abs(i.length-a.length),d=X({id:o,position:"first",contentState:t}),c=t.getIn([d])?.name??"divi/column";return{isStructureSame:l,operation:s,moduleCount:{[c]:{moduleName:c,count:u}}}})({id:e.id,originStructure:e?.columnStructureOrigin??"",targetStructure:e?.columnStructure??"",contentState:r.getIn(["content"])});t||(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:o,modules:i});break}case"CLEAR_LAYOUT":(0,a.dispatch)("divi/module").clearModuleCount({layout:n});break;case"CLONE_MODULE":{const t=ee({id:e?.params?.id,position:"after",contentState:r.getIn(["content"])});t&&(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:"increase",modules:Z({id:t,contentState:r.getIn(["content"])})});break}case"COPY_MODULE":case"COPY_MODULE_FROM_PAYLOAD":{const t=e?.params?.targetId,o="inside"===e?.params?.position?X({id:t,position:"last",contentState:r.getIn(["content"])}):ee({id:t,position:"after",contentState:r.getIn(["content"])});o&&(0,a.dispatch)("divi/module").setModuleCount({layout:e?.params?.themeBuilderLayout??n,operation:"increase",modules:Z({id:o,contentState:r.getIn(["content"])})});break}case"COPY_MODULES_FROM_PAYLOAD":default:break;case"COPY_MODULE_FROM_LIBRARY":{const t=e?.targetId,o="inside"===e?.position?X({id:t,position:"last",contentState:r.getIn(["content"])}):ee({id:t,position:"after",contentState:r.getIn(["content"])});o&&(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:"increase",modules:Z({id:o,contentState:r.getIn(["content"])})});break}case"IMPORT_CONTENT":"on"===e?.importOptionsValues?.replaceLayout?(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:"set",modules:J({contentState:r.getIn(["content"])})}):(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:"increase",modules:J({contentState:H(e?.content)})});break;case"MERGE_GLOBAL_MODULES":(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:"increase",modules:J({contentState:e?.content})});break;case"REMOVE_MODULE":case"REMOVE_COLUMN":(0,a.dispatch)("divi/module").setModuleCount({layout:n,operation:"decrease",modules:Z({id:e?.id,contentState:r.getIn(["content"])})});break;case"SET_LAYOUT_STATE":(0,a.dispatch)("divi/module").setModuleCount({layout:(o=e.location,te[o]??o),operation:"set",modules:J({contentState:r.getIn(["content"])})})}var o},re=(e,t,n="user")=>({type:"ADD_COLUMN_VIA_DIVIDER",id:e,dividerPosition:t,caller:n}),oe=(e,t,n,r,o)=>({type:"ADD_FLEX_COLUMN_VIA_DIVIDER",rowId:e,columnId:t,position:n,builderVersion:r,caller:o}),ie=e=>({type:"CONVERT_SELECTED_MODULES_TO_GROUP",selectedModuleIds:e}),ae=({id:e,position:t,template:n,isAddSection:r})=>({type:"ADD_GRID",id:e,position:t,template:n,isAddSection:r}),le=(e,t,n={},r="inside",o="",i="user")=>({type:"ADD_MODULE",id:e,name:t,props:n,position:r,newId:o,caller:i}),se=e=>({type:"ADD_MODULE_GROUP",id:e}),ue=(e,t,n,r=!1,o="user")=>({type:"ADD_ROW",id:e,position:t,columnStructure:n,inner:r,caller:o}),de=(e,t,n,r)=>({type:"ADD_SPECIALTY_SECTION",id:e,position:t,columnStructure:n,innerPosition:r}),ce=(e,t,n="user",r="module-settings")=>({type:"CHANGE_COLUMN_STRUCTURE",id:e,columnStructure:t,caller:n,context:r}),pe=({id:e,value:t,breakpoint:n,state:r,context:o})=>({type:"CHANGE_FLEX_COLUMN_STRUCTURE",id:e,value:t,breakpoint:n,state:r,context:o}),me=({id:e,value:t,breakpoint:n,state:r,context:o})=>({type:"CHANGE_GRID_COLUMN_STRUCTURE",id:e,value:t,breakpoint:n,state:r,context:o}),ge=e=>({type:"RESET_FLEX_COLUMN_STRUCTURE",...e}),fe=({id:e,value:t,breakpoint:n,state:r})=>({type:"CHANGE_PRICING_TABLES_FLEX_COLUMN_STRUCTURE",id:e,value:t,breakpoint:n,state:r}),Ie=(e,t,n="user")=>({type:"CHANGE_COLUMN_STRUCTURE_FOR_DRAG_AND_DROP",sourceId:e,targetId:t,caller:n}),ye=({id:e,parentRowId:t,targetRowColumnStructure:n})=>({type:"CHANGE_FLEX_COLUMN_STRUCTURE_FOR_DRAG_AND_DROP",id:e,parentRowId:t,targetRowColumnStructure:n}),Ee=()=>({type:"CLEAR_LAYOUT"}),_e=e=>({type:"CLEAR_REMOVED_MODULES",params:e}),he=e=>({type:"CLONE_COLUMN",params:e}),Me=e=>({type:"CLONE_FLEX_COLUMN",params:e}),be=(e,t)=>({type:"CLONE_MODULE",params:e,name:t}),ve=e=>({type:"COPY_MODULE",params:e}),Oe=(e,t,n,r="user")=>({type:"COPY_MODULE_FROM_LIBRARY",payload:e,position:t,targetId:n,caller:r}),Ae=(e,t)=>({type:"COPY_MODULE_FROM_PAYLOAD",params:e,name:t}),Te=e=>({type:"COPY_MODULES_FROM_PAYLOAD",params:e}),Ce=e=>({type:"DISABLE_GLOBAL_MODULE",id:e}),Le=(e,t)=>({type:"EDIT_CHILDREN",id:e,children:t}),De=(e,t,n)=>({type:"EDIT_LOCAL_ATTRS_MAP",id:e,attribute:t,isSynced:n}),Se=e=>({type:"EDIT_LOCAL_CHILDREN",params:e}),Re=({id:e,attrName:t,value:n,caller:r="user",subName:o})=>({type:"EDIT_MODULE_ATTRIBUTE",id:e,attrName:t,value:n,caller:r,subName:o}),Pe=({id:e,presetId:t,caller:n="user"})=>({type:"ADD_MODULE_PRESET_TO_STACK",id:e,presetId:t,caller:n}),Ue=({id:e,presetId:t,caller:n="user"})=>({type:"REMOVE_MODULE_PRESET_FROM_STACK",id:e,presetId:t,caller:n}),Ne=({id:e,oldPresetId:t,newPresetId:n,caller:r="user"})=>({type:"REPLACE_MODULE_PRESET_IN_STACK",id:e,oldPresetId:t,newPresetId:n,caller:r}),ke=({id:e,groupId:t,groupName:n,presetId:r,caller:o="user"})=>({type:"ADD_GROUP_PRESET_TO_STACK",id:e,groupId:t,groupName:n,presetId:r,caller:o}),we=({id:e,groupId:t,presetId:n,caller:r="user"})=>({type:"REMOVE_GROUP_PRESET_FROM_STACK",id:e,groupId:t,presetId:n,caller:r}),Ge=({id:e,groupId:t,oldPresetId:n,newPresetId:r,caller:o="user"})=>({type:"REPLACE_GROUP_PRESET_IN_STACK",id:e,groupId:t,oldPresetId:n,newPresetId:r,caller:o}),Ve=(e,t,n)=>({type:"EDIT_MODULE_PROP",id:e,propName:t,propValue:n}),Fe=({content:e,presetIdsToReplace:t,defaultPresetAttrs:n,importOptionsValues:r,defaultImportedModulePresetIds:o,defaultImportedGroupPresetIds:i})=>({type:"IMPORT_CONTENT",content:e,presetIdsToReplace:t,defaultPresetAttrs:n,importOptionsValues:r,defaultImportedModulePresetIds:o,defaultImportedGroupPresetIds:i}),xe=(e,t)=>({type:"MERGE_GLOBAL_MODULES",content:e,owner:t}),Be=(e,t,n,r="user")=>({type:"MOVE_MODULE",id:e,position:t,targetId:n,caller:r}),je=(e,t,n)=>({type:"MOVE_MODULES",ids:e,position:t,targetId:n});var Ye=window.divi.clipboard;const $e=(e,t,n)=>{if((0,g.isEqual)(e,t))return!0;if(n&&(0,Q.isTransformScaleField)(n.fieldComponent.name,n.attrName,n.subName)){const n=(0,Q.processPercentageValue)(e,Q.convertPercentageToDecimal),r=(0,Q.processPercentageValue)(t,Q.convertPercentageToDecimal);return(0,g.isEqual)(n,r)}return!1},He=(e,t,n,r={})=>{const o=n&&(0,Q.isTransformScaleField)(n.fieldComponent.name,n.attrName,n.subName)?(0,Q.processPercentageValue)(t,Q.formatAsPercentageString):t,a=(0,Q.ensureImmutable)(o);function l(t){if(null==t)return t;if(r.restrictToPath&&r.onlyExactPaths)return(0,Q.isImmutableObject)(t)&&"setIn"in t?function(t){const{restrictToPath:o}=r;if(!o)return t;const{attrName:i,subName:l,breakpoints:s,states:u}=o,d=i.split(".");let c=t,p=!1;return s.forEach((t=>{u.forEach((r=>{const o=(0,Ye.getFullAttrPath)({attrNamePath:d,breakpoint:t,state:r,subNamePath:l?l.split("."):[]}),i=(0,Q.safeGetIn)(c,o);null!==i&&$e(i,e,n)&&(c=c.setIn(o,a),p=!0)}))})),p?c:t}(t):t;if($e(t,e,n)){const e=((e,t,n)=>t&&n&&(!e||""===e||"string"==typeof e&&""===e.trim())?null:e)(o,n,t);if(null===e)return null;return(0,Q.ensureImmutable)(e)}return function(e){if("object"!=typeof e)return e;if((0,Q.isImmutableObject)(e)){const t=e.asMutable({deep:!0}),n=l(t);return n===t?e:n?i()(n):null}if(Array.isArray(e)){const t=[];let n=!1;return e.forEach(((e,r)=>{if((0,Q.isValidModuleAttr)(e)){const o=l(e);null!==o?(t[r]=o,o!==e&&(n=!0)):n=!0}else t[r]=e})),n?t:e}if((0,Q.isPlainObject)(e)){const t={};let n=!1;return Object.keys(e).forEach((r=>{const o=e[r],i=l(o);null!==i?(t[r]=i,i!==o&&(n=!0)):n=!0})),n?t:e}return e}(t)}return l},ze=e=>{const{sourceFieldInfo:t,selectedScope:n,selectedModuleTypes:r,findValue:o,replaceValue:i,onlyReplaceIdenticalFields:l,selectedSourceModule:s}=e;if(!t)return{type:"PERFORM_FIND_REPLACE_FAILED",error:"No source field"};if(!o&&0!==o&&!1!==o)return{type:"PERFORM_FIND_REPLACE_FAILED",error:"No find value"};const u=(0,a.select)("divi/settings").getEnabledBreakpointNames(),d=Q.states,c=(0,Q.getModulesInScope)(s,n,[],r,!0);if(0===c.length)return{type:"PERFORM_FIND_REPLACE_FAILED",error:"No modules found"};const{attrName:p,subName:m}=t,g=He(o,i,t,l?{restrictToPath:{attrName:p,subName:m,breakpoints:u,states:d},onlyExactPaths:!0}:{});let f=0;return c.forEach((e=>{try{const t=(0,a.select)("divi/edit-post").getModuleAttrs(e);if(!t)return;const n=g(t);n&&(0,Q.isImmutableObject)(n)&&"setIn"in n&&n!==t&&((0,a.dispatch)("divi/edit-post").replaceModuleAttributes(e,n,"user",!0),f++)}catch(e){}})),{type:"PERFORM_FIND_REPLACE_SUCCESS",changesCount:f}},We=(e,t="user")=>({type:"REMOVE_COLUMN",id:e,caller:t}),Ke=e=>({type:"REMOVE_GLOBAL_MODULE_ATTRIBUTE",id:e}),Xe=e=>({type:"REMOVE_GLOBAL_PARENT_ATTRIBUTE",id:e}),qe=(e,t="user")=>({type:"REMOVE_MODULE",id:e,caller:t}),Je=(e,t,n,r="user")=>({type:"REMOVE_GROUP_PRESET_ATTRIBUTE",id:e,attrName:t,groupId:n,caller:r}),Qe=(e,t,n="user")=>({type:"REMOVE_MODULE_ATTRIBUTE",id:e,attrName:t,caller:n}),Ze=({id:e,attrNames:t,caller:n="user"})=>({type:"REMOVE_MODULE_ATTRIBUTES",id:e,attrNames:t,caller:n}),et=e=>({type:"REMOVE_MODULE_STATE_PROPERTIES",params:e}),tt=(e,t,n="user",r=!1)=>({type:"REPLACE_MODULE_ATTRIBUTES",id:e,attrs:t,caller:n,replaceAllAttrs:r}),nt=({id:e,owner:t,caller:n="user"})=>({type:"REVERT_GLOBAL_MODULE_EDIT_STATE",id:e,owner:t,caller:n}),rt=(e,t)=>({type:"SET_GLOBAL_MODULE_ATTRIBUTE",id:e,value:t}),ot=(e,t)=>({type:"SET_GLOBAL_PARENT_ATTRIBUTE",id:e,value:t}),it=({location:e,layoutState:t})=>({type:"SET_LAYOUT_STATE",location:e,layoutState:t}),at=e=>({type:"SET_SPECIALITY_SECTION_STATUS",status:e}),lt=(e,t,n)=>({type:"SYNC_GLOBAL_LAYOUT_ATTRIBUTES",id:e,attrs:t,localAttrsMap:n}),st=e=>({type:"SYNC_MODULE_GLOBAL_COLORS",globalColors:e}),ut=()=>({type:"SYNC_MODULE_INLINE_FONT"}),dt=({presetType:e,presets:t})=>({type:"UPDATE_USED_PRESETS",presetType:e,presets:t}),ct=({id:e,attrName:t,value:n})=>({type:"EDIT_GROUP_PRESET_ATTR",id:e,attrName:t,value:n}),pt=(e,t)=>({type:"SET_MODULE_LOOP_DATA",id:e,loopData:t});var mt=window.vendor.wp.i18n;const gt=(e,t)=>{if("caller"in e&&"global-layout"===e.caller||"params"in e&&e.params&&"caller"in e.params&&"global-layout"===e.params.caller)return;const n={ADD_COLUMN_VIA_DIVIDER:(0,mt.__)("Added Column","et_builder"),ADD_FLEX_COLUMN_VIA_DIVIDER:(0,mt.__)("Added Flex Column","et_builder"),ADD_MODULE:(0,mt.__)("Added %s","et_builder"),ADD_ROW:(0,mt.__)("Added Row","et_builder"),ADD_GRID:(0,mt.__)("Added Flex Grid","et_builder"),ADD_SPECIALTY_SECTION:(0,mt.__)("Added Specialty Section","et_builder"),CHANGE_COLUMN_STRUCTURE:(0,mt.__)("Changed Column Structure","et_builder"),CHANGE_FLEX_COLUMN_STRUCTURE:(0,mt.__)("Changed Flex Column Structure","et_builder"),CLEAR_LAYOUT:(0,mt.__)("Cleared Layout","et_builder"),CLONE_MODULE:(0,mt.__)("Cloned %s","et_builder"),CLONE_COLUMN:(0,mt.__)("Cloned Column","et_builder"),CONVERT_SELECTED_MODULES_TO_GROUP:(0,mt.__)("Created Group","et_builder"),COPY_MODULE_FROM_PAYLOAD:(0,mt.__)("Copied %s","et_builder"),COPY_MODULES_FROM_PAYLOAD:(0,mt.__)("Copied Modules","et_builder"),EDIT_CHILDREN:(0,mt.__)("Edited %s Child Modules","et_builder"),EDIT_MODULE_ATTRIBUTE:(0,mt.__)("Edited %s","et_builder"),EDIT_MODULE_PROP:(0,mt.__)("Edited %s","et_builder"),EDIT_LOCAL_ATTRS_MAP:(0,mt.__)("Edited Local Attributes","et_builder"),IMPORT_CONTENT:(0,mt.__)("Imported Content","et_builder"),MOVE_MODULE:(0,mt.__)("Moved %s","et_builder"),MOVE_MODULES:(0,mt.__)("Moved Modules","et_builder"),REMOVE_COLUMN:(0,mt.__)("Removed Column","et_builder"),REMOVE_MODULE:(0,mt.__)("Removed %s","et_builder"),REMOVE_MODULE_ATTRIBUTE:(0,mt.__)("Removed Module Attribute","et_builder"),REPLACE_MODULE_ATTRIBUTES:(0,mt.__)("Replaced Module Attributes","et_builder"),ADD_MODULE_PRESET_TO_STACK:(0,mt.__)("Added Module Preset","et_builder"),REMOVE_MODULE_PRESET_FROM_STACK:(0,mt.__)("Removed Module Preset","et_builder"),REPLACE_MODULE_PRESET_IN_STACK:(0,mt.__)("Replaced Module Preset","et_builder"),ADD_GROUP_PRESET_TO_STACK:(0,mt.__)("Added Group Preset","et_builder"),REMOVE_GROUP_PRESET_FROM_STACK:(0,mt.__)("Removed Group Preset","et_builder"),REPLACE_GROUP_PRESET_IN_STACK:(0,mt.__)("Replaced Group Preset","et_builder")},r=t.getState()?.getIn(["content"]),o=e?.type??"",i="id"in e?e.id:"",l="name"in e?e.name:r?.[i]?.name??"",s=(0,a.select)("divi/module-library").getModule(l)?.title??"";let u=n?.[o];u?.includes("%s")&&(u=(0,mt.sprintf)(u,s));const d=new Date,c=d.getTime(),p=d.toLocaleTimeString();(0,a.dispatch)("divi/history").addLayoutItem({label:u,moduleId:i,moduleLabel:s,moduleName:l,state:r,timestamp:c,humanTime:p,type:o,storeName:"divi/edit-post"})},ft=(e,t)=>{if("caller"in e&&"global-layout"===e.caller||"params"in e&&e.params&&"caller"in e.params&&"global-layout"===e.params.caller)return;const n=(0,g.get)(e,"id")||"",r={label:(0,g.get)(t.getState(),["content",n,"name"]),details:""};if("EDIT_MODULE_ATTRIBUTE"===e.type){const t=(0,g.isString)(e.value)?e.value:JSON.stringify(e.value);r.details=`${e.attrName}: ${t}`}const o=(0,g.get)(e,"presetId"),i=(0,g.get)(e,"newPresetId"),l=(0,g.get)(e,"oldPresetId"),s=(0,g.get)(e,"groupId");(o||i)&&(e.type.includes("ADD_MODULE_PRESET_TO_STACK")?r.details=`Added module preset: ${o}`:e.type.includes("REMOVE_MODULE_PRESET_FROM_STACK")?r.details=`Removed module preset: ${o}`:e.type.includes("REPLACE_MODULE_PRESET_IN_STACK")?r.details=`Replaced module preset: ${l} → ${i}`:e.type.includes("ADD_GROUP_PRESET_TO_STACK")?r.details=`Added group preset (${s}): ${o}`:e.type.includes("REMOVE_GROUP_PRESET_FROM_STACK")?r.details=`Removed group preset (${s}): ${o}`:e.type.includes("REPLACE_GROUP_PRESET_IN_STACK")&&(r.details=`Replaced group preset (${s}): ${l} → ${i}`));let u=n;if("CONVERT_SELECTED_MODULES_TO_GROUP"===e.type){r.label="divi/group";const n=(0,g.get)(e,"selectedModuleIds.0");n&&(u=(0,g.get)(t.getState(),["content",n,"parent"],""))}(0,a.dispatch)("divi/history").add("edit-post",e.type,u,r)},It=(e,t)=>{const{id:n}=e,r=(0,a.select)("divi/edit-post").getModule(n),o=r?.props?.attrs,i=r?.name;if(!o||!i||!o.modulePreset)return;const l=(0,Q.mergeNestedGroupPresets)(o.modulePreset,i,o);if(0===Object.keys(l).length)return;const s=o.getIn(["groupPreset"],null);if(!s)return;const u=(0,Q.isImmutable)(s)?s.asMutable({deep:!0}):s,d={};Object.keys(u).forEach((e=>{const t=u[e],r=l[e];if(!t?.presetId||!r?.presetId)return;const o=(0,Q.normalizePresetStack)(t.presetId),i=(0,Q.normalizePresetStack)(r.presetId),s=o.filter((e=>!i.includes(e)));s.length!==o.length&&(0===s.length?(0,a.dispatch)("divi/edit-post").removeGroupPresetAttribute(n,"groupPreset",e,"preset"):d[e]={presetId:s,groupName:t.groupName})})),Object.entries(d).forEach((([e,t])=>{(0,a.dispatch)("divi/edit-post").editGroupPresetAttr({id:n,attrName:e,value:{presetId:t.presetId,groupName:t.groupName}})}))},yt=e=>{const t=(0,a.select)("divi/edit-post").getModuleWithChildren(e.id),n=Object.values(t).find((e=>e&&!!(0,a.select)("divi/modal-library").isModuleEdited(e.id))),r=e.id===n?.id,o=!r&&void 0!==n,i=(0,a.select)("divi/edit-post").getParentModuleId(e.id);if(r||o){const e="divi/shortcode-module"===(0,a.select)("divi/edit-post").getModuleName(i)?"divi/module-shortcode":"divi/module";"root"===i?(0,a.dispatch)("divi/modal-library").open({name:"divi/page-settings"}):(0,a.dispatch)("divi/modal-library").open({name:e,owner:i})}};let Et=null;const _t=(0,g.debounce)(((e,t)=>((e,t)=>{"object"==typeof window.ET_Builder&&requestAnimationFrame((()=>{e.forEach((e=>{try{const n=document.querySelector(`[data-id="${e}"]`);if(n?.classList.contains("et_pb_group_carousel_initialized")){const r=new CustomEvent("divi:groupCarousel:regenerateClones",{detail:{carouselId:e,moduleId:t},bubbles:!1,cancelable:!1});n.dispatchEvent(r)}}catch(e){}}))}))})(e,t)),300),ht=new Map,Mt=["CLONE_MODULE","COPY_MODULE_FROM_PAYLOAD","COPY_MODULES_FROM_PAYLOAD","MOVE_MODULE","REMOVE_MODULE"],bt=(e,t,n)=>e.attrName===t&&(e.subName&&n?n===e.subName||n.startsWith(`${e.subName}.`):!e.subName&&!n),vt=e=>{if("EDIT_LOCAL_CHILDREN"!==e.type&&("caller"in e&&"global-layout"===e.caller||"params"in e&&e.params&&"caller"in e.params&&"global-layout"===e.params.caller))return;if("EDIT_CHILDREN"===e.type&&"caller"in e&&"global-layout"===e.caller)return;const t=[];let n="";const r=e=>(0,a.select)("divi/edit-post").getGlobalLayoutId(e),o=(0,a.select)("divi/module").getModuleCount(),i="ADD_MODULE"===e.type&&"id"in e&&(0,a.select)("divi/module-library").isChildModule(e.name)||"CLONE_MODULE"===e.type;switch(e.type){case"ADD_COLUMN_VIA_DIVIDER":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"ADD_FLEX_COLUMN_VIA_DIVIDER":{const{rowId:o,columnId:i}=e,a=r(i),l=r(o);a?(t.push(a),n=i):l&&(t.push(l),n=o);break}case"ADD_GRID":{const{id:o,position:i,isAddSection:l}=e;if(l&&"inside"!==i)break;const s="inside"===i?o:(0,a.select)("divi/edit-post").getParentModule(o)?.id;if(s&&"root"!==s){const e=(0,a.select)("divi/edit-post").getModule(s),o=e?.props?.attrs?.globalModule,i=e?.props?.attrs?.globalParent,l=o||i?r(s):null;l&&(t.push(l),n=s)}break}case"ADD_MODULE":{const{id:o,position:i}=e;if("root"===o)return;const l="inside"===i?o:(0,a.select)("divi/edit-post").getParentModule(o)?.id;if(l&&"root"!==l){const e=(0,a.select)("divi/edit-post").getModule(l),o=e?.props?.attrs?.globalModule,i=e?.props?.attrs?.globalParent,s=o||i?r(l):null;s&&(t.push(s),n=l)}break}case"ADD_ROW":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"CHANGE_COLUMN_STRUCTURE":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"CHANGE_FLEX_COLUMN_STRUCTURE":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"CHANGE_GRID_COLUMN_STRUCTURE":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"CLONE_FLEX_COLUMN":{const{id:o}=e.params,i=r(o);i&&(t.push(i),n=o);break}case"CLONE_MODULE":{const{id:o}=e.params,i=(0,a.select)("divi/edit-post").getModule(o),l=r(o);if(l){if(i&&(0,a.select)("divi/module-library").isChildModule(i.name)){const e=(0,a.select)("divi/edit-post").getParentModule(o)?.id;n=e}else n=o;t.push(l)}break}case"COPY_MODULE_FROM_PAYLOAD":{const{targetId:o}=e.params;if("root"===o)return;const i=r(o);if(i){let e=o;const r=i;for(;e;){const o=(0,a.select)("divi/edit-post").getModule(e);if(o&&o.props?.attrs?.globalModule===r){n=e,t.push(r);break}const i=(0,a.select)("divi/edit-post").getParentModule(e);if(!i)break;e=i.id}}else{const e=(0,a.select)("divi/edit-post").getParentModule(o);if(e){const o=e.id,i=r(o);if(i)n=o,t.push(i);else{const e=(0,a.select)("divi/edit-post").getParentModule(o);if(e){const o=e.id,i=r(o);i&&(n=o,t.push(i))}}}}break}case"COPY_MODULES_FROM_PAYLOAD":{const{targetId:o}=e.params;r(o)&&(n=o,t.push(r(o)));break}case"EDIT_GROUP_PRESET_ATTR":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"EDIT_CHILDREN":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"EDIT_MODULE_ATTRIBUTE":{const{id:o,attrName:i}=e;if(!(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:o,attrName:i})){const e=r(o),t=!(0,a.select)("divi/history").isHistoryTrackingEnabled();if(e&&t){const t=(0,a.select)("divi/global-layouts").getLayout(e)?.preEditContent;!!t&&(0,a.dispatch)("divi/history").enableHistoryTracking()}return}const l=r(o);if(l)n=o,t.push(l);else{const e=(0,a.select)("divi/edit-post").getModule(o);if(e&&(0,a.select)("divi/module-library").isChildModule(e.name)){const e=(0,a.select)("divi/edit-post").getParentModule(o)?.id,i=r(e);i&&(n=e,t.push(i))}}break}case"EDIT_LOCAL_ATTRS_MAP":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"EDIT_LOCAL_CHILDREN":{const{id:o}=e.params;r(o)&&(n=o,t.push(r(o)));break}case"MOVE_MODULE":{const{id:o,targetId:i}=e,l=r(o),s=r(i);if(l&&((0,a.select)("divi/modal-library").isModuleEdited(o)&&(n=o),t.push(l)),s&&l!==s&&((0,a.select)("divi/modal-library").isModuleEdited(i)&&(n=i),t.push(s)),!n){const e=(0,a.select)("divi/edit-post").getModule(o);e&&e.parent?n=e.parent:l?n=l:s&&(n=s)}break}case"MOVE_MODULES":{const{ids:o,targetId:i}=e;o.forEach((e=>{r(e)&&(n=e,t.push(r(e)))})),r(i)&&(n=i,t.push(r(i)));break}case"REMOVE_COLUMN":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"REMOVE_MODULE":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"REMOVE_MODULE_ATTRIBUTE":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}case"REPLACE_MODULE_ATTRIBUTES":{const{id:o}=e;r(o)&&(n=o,t.push(r(o)));break}default:return}if((0,g.forEach)(t,(t=>{if(!((e,t)=>{const n=ht.get(e);return!!n&&n.has(t)})(t,e.type)){((e,t)=>{ht.has(e)||ht.set(e,new Set),ht.get(e)?.add(t)})(t,e.type);try{const l=[];let s="",u="",d="",c="";const p=(0,a.select)("divi/global-layouts").getGlobalLayoutMap(t),m={addColumnViaDivider:()=>"ADD_COLUMN_VIA_DIVIDER"===e.type&&(0,a.dispatch)("divi/edit-post").addColumnViaDivider(c,e.dividerPosition,"global-layout"),addGrid:()=>"ADD_GRID"===e.type&&((0,a.dispatch)("divi/edit-post").addGrid({id:c,isAddSection:e.isAddSection,position:e.position,template:e.template}),!0),cloneFlexColumn:()=>{if("CLONE_FLEX_COLUMN"===e.type&&"params"in e){const t=p.filter((e=>c in e))[0];if(!t)return!1;const n=p.find((t=>e.params.id in t));if(!n||Object.keys(n).join()===Object.keys(t).join())return!1;let r=e.params.id,o=null,i=-1;const l=Object.entries(n).find((([,t])=>t.children&&t.children.includes(e.params.id)));if(l){const[t,n]=l;o=t,i=n.children.indexOf(e.params.id)}if(null!==o&&i>=0){let e=null;if(t[o])e=o;else{const r=Object.entries(n).find((([,e])=>e.children&&e.children.includes(o)));if(r){const[n,i]=r,a=i.children.indexOf(o);let l=n;if(!t[n]){const e=Object.keys(t).find((e=>{const n=t[e];return n&&n.children&&n.children.length>a}));e&&(l=e)}const s=t[l];s&&s.children&&s.children.length>a&&(e=s.children[a])}}if(e&&t[e]&&t[e].children){const n=t[e];n.children.length>i&&(r=n.children[i])}}return(0,a.dispatch)("divi/edit-post").cloneFlexColumn({...e.params,id:r}),!0}return!1},addFlexColumnViaDivider:()=>{if("ADD_FLEX_COLUMN_VIA_DIVIDER"===e.type){const t=p.filter((e=>c in e))[0];if(!t)return!1;const n=p.find((t=>e.rowId in t&&e.columnId in t));if(!n||Object.keys(n).join()===Object.keys(t).join())return!1;let r=e.rowId,o=e.columnId;if(e.rowId in t)r=e.rowId;else{const o=Object.entries(n).find((([,t])=>t.children&&t.children.includes(e.rowId)));if(o){const[n,i]=o,a=i.children.indexOf(e.rowId);let l=n;if(!t[n]){const e=Object.entries(t).find((([,e])=>e.children&&e.children.length>a));e&&(l=e?.[0])}const s=t[l];s&&s.children&&s.children[a]&&(r=s.children[a])}}const i=n[e.rowId],l=t[r];if(i&&l&&i.children&&l.children){const t=i.children.indexOf(e.columnId);t>=0&&t<l.children.length&&(o=l.children[t])}return(0,a.dispatch)("divi/edit-post").addFlexColumnViaDivider(r,o,e.position,void 0,"global-layout")}return!1},addModule:()=>{if("ADD_MODULE"===e.type){if(i&&(0,a.select)("divi/module-library").isChildModule(e.name))return!1;if(!(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:e.id}))return!1;const t=b();return(0,a.dispatch)("divi/edit-post").addModule(c,e.name,e.props,e.position,t,"global-layout")}return!1},addRow:()=>"ADD_ROW"===e.type&&(0,a.dispatch)("divi/edit-post").addRow(c,e.position,e.columnStructure,e.inner,"global-layout"),changeColumnStructure:()=>{if("CHANGE_COLUMN_STRUCTURE"===e.type){return!!(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:e.id})&&(0,a.dispatch)("divi/edit-post").changeColumnStructure(c,e.columnStructure,"global-layout")}return!1},changeFlexColumnStructure:()=>{if("CHANGE_FLEX_COLUMN_STRUCTURE"===e.type){return!!(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:e.id})&&(0,a.dispatch)("divi/edit-post").changeFlexColumnStructure({id:c,value:e.value,breakpoint:e.breakpoint,state:e.state})}return!1},changeGridColumnStructure:()=>{if("CHANGE_GRID_COLUMN_STRUCTURE"===e.type){return!!(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:e.id})&&(0,a.dispatch)("divi/edit-post").changeGridColumnStructure({id:c,value:e.value,breakpoint:e.breakpoint,state:e.state})}return!1},cloneModule:()=>{if("CLONE_MODULE"===e.type){const t=(0,a.select)("divi/edit-post").getModule(e.params.id);if(i&&t&&(0,a.select)("divi/module-library").isChildModule(t.name))return!1;return!!(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:e.params.id})&&(0,a.dispatch)("divi/edit-post").cloneModule({id:c,caller:"global-layout",moduleCount:o})}return!1},copyModuleFromPayload:()=>"COPY_MODULE_FROM_PAYLOAD"===e.type&&(0,a.dispatch)("divi/edit-post").copyModuleFromPayload({payload:e.params.payload,position:e.params.position,targetId:c,caller:"global-layout",moduleCount:o}),copyModulesFromPayload:()=>"COPY_MODULES_FROM_PAYLOAD"===e.type&&(0,a.dispatch)("divi/edit-post").copyModulesFromPayload({payload:e.params.payload,position:e.params.position,targetId:c,caller:"global-layout",moduleCount:o}),editModuleAttribute:()=>{if("EDIT_MODULE_ATTRIBUTE"===e.type){const t="subName"in e&&e.subName,n=(0,a.select)("divi/edit-post").getModuleAttr(s,"localAttrsMap");if(!(!(!("attrName"in e)||!Array.isArray(n))&&n.some((n=>bt(n,e.attrName,t))))){const t=(0,a.select)("divi/edit-post").getModuleAttr(c,"localAttrsMap");if(Array.isArray(t)&&t.length>0){const n=(0,a.select)("divi/edit-post").getModuleAttrs(c);if(n){const r=n.setIn(e.attrName.split("."),e.value);(0,a.dispatch)("divi/edit-post").syncGlobalLayoutAttributes(c,r,t)}}else(0,a.dispatch)("divi/edit-post").editModuleAttribute({id:c,attrName:e.attrName,value:e.value,caller:"global-layout",subName:"subName"in e&&e.subName})}}},moveModule:()=>{if("MOVE_MODULE"===e.type){(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:u})&&(0,a.dispatch)("divi/edit-post").moveModule(u,e.position,d,"global-layout")}},removeColumn:()=>{if("REMOVE_COLUMN"===e.type){(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:c})&&(0,a.dispatch)("divi/edit-post").removeColumn(c,"global-layout")}},removeModule:()=>{if("REMOVE_MODULE"===e.type){(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:e.id})&&(0,a.dispatch)("divi/edit-post").removeModule(c,"global-layout")}},removeModuleAttribute:()=>{if("REMOVE_MODULE_ATTRIBUTE"===e.type){(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:c,attrName:e.attrName})&&(0,a.dispatch)("divi/edit-post").removeModuleAttribute(c,e.attrName,"global-layout")}},replaceModuleAttributes:()=>{if("REPLACE_MODULE_ATTRIBUTES"===e.type){(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:c})&&(0,a.dispatch)("divi/edit-post").replaceModuleAttributes(c,e.attrs,"global-layout")}},editLocalAttrsMap:()=>{if("EDIT_LOCAL_ATTRS_MAP"===e.type){if((0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate({moduleId:s})){const e=(0,a.select)("divi/edit-post").getModuleAttrs(s),t=e?.localAttrsMap,n=t||[];(0,a.dispatch)("divi/edit-post").syncGlobalLayoutAttributes(c,e,n)}}},editLocalChildren:()=>{if("EDIT_LOCAL_CHILDREN"===e.type){const e=(0,a.select)("divi/edit-post").getModuleAttrs(s),t=e?.localAttrsMap,n=t??[];(0,a.dispatch)("divi/edit-post").syncGlobalLayoutAttributes(c,e,n)}},editChildren:()=>{if("EDIT_CHILDREN"===e.type){if(!0===(0,a.select)("divi/edit-post").getModuleAttr(e.id,"localChildren"))return;const t=e.children,n=(0,a.select)("divi/edit-post").getModule(c);if(n&&Array.isArray(t)&&Array.isArray(n.children)){const e=n.children,r=[...t].sort(),o=t.map((e=>r.indexOf(e))).filter((e=>e>=0)).map((t=>(e?.asMutable()??[])[t])).filter(Boolean);(0,a.dispatch)("divi/edit-post").editChildren(c,o)}}}},f=(0,g.camelCase)(e.type),I="EDIT_MODULE_ATTRIBUTE"!==e.type,y=(0,a.select)("divi/edit-post").getGlobalLayoutOwners(t);let E;if("CLONE_MODULE"===e.type&&"params"in e){const t=e.params.id,n=(0,a.select)("divi/edit-post").getParentModule(t);if(n&&Array.isArray(n.children)){const e=n.children.indexOf(t);if(e>=0&&e+1<n.children.length){const t=n?.children?.asMutable()??[];E=t?.[e+1]}}}let _=!1;if("REMOVE_MODULE"===e.type){const t=(0,a.select)("divi/edit-post").getModule(e.id);_=!!t?.props?.attrs?.globalModule}(0,g.forEach)(y,(e=>{(0,a.select)("divi/modal-library").isModuleEdited(e)||((e,t)=>{let n=!1;const r=(e,t)=>{if(!t)return;const o=(0,a.select)("divi/edit-post").getParentModule(t)?.id;o&&o===e?n=!0:o&&"root"!==o&&r(e,o)};return r(e,t),n})(e,n)||e===n?s=e:e!==E&&l.push(e)}));const h=(n,i,l=!1)=>{if("CLONE_MODULE"===e.type&&"params"in e&&e.params.caller&&"user"===e.params.caller){const t=(0,a.select)("divi/edit-post").getModule(e.params.id)?.props?.attrs?.globalModule;if(t)return}if("REMOVE_MODULE"===e.type&&"caller"in e&&_)return;const y="id"in e&&n===e.id||"targetId"in e&&n===e.targetId||"CLONE_MODULE"===e.type&&"params"in e&&n===e.params.id||"CLONE_FLEX_COLUMN"===e.type&&"params"in e&&n===e.params.id||"COPY_MODULE_FROM_PAYLOAD"===e.type&&"params"in e&&n===e.params.targetId||"COPY_MODULES_FROM_PAYLOAD"===e.type&&"params"in e&&n===e.params.targetId||"ADD_FLEX_COLUMN_VIA_DIVIDER"===e.type&&(n===e.rowId||n===e.columnId)||"EDIT_CHILDREN"===e.type&&n===e.id||"EDIT_LOCAL_CHILDREN"===e.type&&"params"in e&&n===e.params.id;if("moveModule"!==f&&(!["cloneModule","removeModule","addRow","copyModuleFromPayload","copyModulesFromPayload"].includes(f)||!l)&&y){c=i,m[f]();const n="subName"in e&&e.subName,r=(0,a.select)("divi/edit-post").getModuleAttr(s,"localAttrsMap"),o=!(!("attrName"in e)||!Array.isArray(r))&&r.some((t=>bt(t,e.attrName,n)))||"EDIT_LOCAL_ATTRS_MAP"===e.type;if(!0===(0,a.select)("divi/edit-post").getModuleAttr(s,"localChildren")&&"EDIT_LOCAL_CHILDREN"!==e.type&&"EDIT_LOCAL_ATTRS_MAP"!==e.type)return;let l=!1;if(Mt.includes(e.type))if("CLONE_MODULE"===e.type&&"params"in e){const t=(0,a.select)("divi/edit-post").getModule(e.params.id);t&&!(0,a.select)("divi/module-library").isChildModule(t.name)&&(l=!0)}else{let t="";if("params"in e&&e.params&&"targetId"in e.params){const n=e.type;"COPY_MODULE_FROM_PAYLOAD"!==n&&"COPY_MODULES_FROM_PAYLOAD"!==n||(t=e.params.targetId)}else"id"in e&&(t=e.id);if(t){const e=(0,a.select)("divi/edit-post").getModule(t);e&&e.props?.attrs?.globalModule&&(l=!0)}}if(!o){const n=(0,a.select)("divi/edit-post").getModuleWithChildren(s);(0,a.dispatch)("divi/global-layouts").setLayoutContent({templateId:t,content:n,instanceId:s,syncToServer:!l&&I,sourceAction:{store:"divi/edit-post",action:e.type,context:e?.context}})}if("ADD_MODULE"===e.type||"CLONE_MODULE"===e.type){if("ADD_MODULE"===e.type&&"caller"in e&&"global-layout"===e.caller)return;if("CLONE_MODULE"===e.type&&"params"in e&&e.params.caller&&"global-layout"===e.params.caller)return;(0,a.select)("divi/edit-post").getGlobalLayoutOwners(t).forEach((n=>{if(n!==s&&n!==E){if(!0===(0,a.select)("divi/edit-post").getModuleAttr(n,"localChildren"))return;if("ADD_MODULE"===e.type&&"id"in e&&"newId"in e){if(e.newId?(0,a.select)("divi/edit-post").getModule(e.newId):null){const r=(0,a.select)("divi/global-layouts").getGlobalLayoutMap(t),o=r.find((t=>e.id in t)),i=r.find((e=>n in e));if(o&&i){let t=e.id;const n=Object.keys(o),r=Object.keys(i),l=n.findIndex((t=>t===e.id));l>=0&&l<r.length&&(t=r[l]);const s=b();(0,a.dispatch)("divi/edit-post").addModule(t,e.name,e.props,e.position||"inside",s,"global-layout")}}}else if("CLONE_MODULE"===e.type){const t=e.params.id,r=(0,a.select)("divi/edit-post").getModule(t);if(r&&(0,a.select)("divi/module-library").isChildModule(r.name)){const e=(0,a.select)("divi/edit-post").getModule(r.parent),o=e?.children?.indexOf(t)??-1,i=o>=0?e?.children?.[o+1]:null,l=i?(0,a.select)("divi/edit-post").getModule(i):null;if(l&&i){const e=b(),t=l.props.asMutable({deep:!0});(0,a.dispatch)("divi/edit-post").addModule(n,l.name,t,"inside",e,"global-layout")}}}}}))}return}const M=p?.filter((e=>n in e)),v=M?.[0]?.[n]?.children;Array.isArray(v)&&v.length&&(0,g.forEach)(v,((t,n)=>{const s=p.filter((e=>i in e))[0];if(!s)return;const c=s[i]?.children;if("MOVE_MODULE"===e.type){if(t===e.id&&(u=c[n]),t===e.targetId&&(d=c[n],!r(e.id)))return void(0,a.dispatch)("divi/edit-post").copyModule({id:e.id,position:e.position,targetId:d,moduleCount:o});if(!l&&""!==u&&""!==d)return void m[f]()}const g=(0,a.select)("divi/edit-post").getModule(c[n])?.parent;!0!==(!!g&&(0,a.select)("divi/edit-post").getModuleAttr(g,"localChildren"))&&h(t,c[n],!1)}))};(0,g.forEach)(l,(t=>{!0===(0,a.select)("divi/edit-post").getModuleAttr(t,"localChildren")&&"EDIT_LOCAL_CHILDREN"!==e.type&&"EDIT_LOCAL_ATTRS_MAP"!==e.type||h(s,t,!1)}));const M="subName"in e&&e.subName,v=(0,a.select)("divi/edit-post").getModuleAttr(s,"localAttrsMap"),O=!(!("attrName"in e)||!Array.isArray(v))&&v.some((t=>bt(t,e.attrName,M)));if("EDIT_LOCAL_ATTRS_MAP"===e.type||!O){const n={moduleId:"id"in e?e.id:s};"attrName"in e&&(n.attrName=e.attrName);const r=(0,a.select)("divi/edit-post").shouldSynchronizeToGlobalModuleTemplate(n),o=Mt.includes(e.type);let i=!1;if(o&&s)if("CLONE_MODULE"===e.type&&"params"in e){const t=(0,a.select)("divi/edit-post").getModule(e.params.id);t&&!(0,a.select)("divi/module-library").isChildModule(t.name)&&(i=!0)}else{let t="";if("params"in e&&e.params&&"targetId"in e.params){const n=e.type;"COPY_MODULE_FROM_PAYLOAD"!==n&&"COPY_MODULES_FROM_PAYLOAD"!==n||(t=e.params.targetId)}else"id"in e&&(t=e.id);if(t){const e=(0,a.select)("divi/edit-post").getModule(t);e&&e.props?.attrs?.globalModule&&(i=!0)}}if(r&&s){const n=(0,a.select)("divi/edit-post").getModuleWithChildren(s);(0,a.dispatch)("divi/global-layouts").setLayoutContent({templateId:t,content:n,instanceId:s,syncToServer:!i&&I,sourceAction:{store:"divi/edit-post",action:e.type,context:e?.context}})}}}finally{((e,t)=>{const n=ht.get(e);n&&(n.delete(t),0===n.size&&ht.delete(e))})(t,e.type)}}})),t.length>0){const e=t[0],n=!(0,a.select)("divi/history").isHistoryTrackingEnabled(),r=(0,a.select)("divi/global-layouts").getLayout(e)?.preEditContent,o=!!r;n&&o&&(0,a.dispatch)("divi/history").enableHistoryTracking()}},Ot=(e,t)=>{const n=(0,g.get)(t.getState()?.asMutable({deep:!0}),"content"),r=(0,Q.populateUsedGroupPresets)(n);(0,a.dispatch)("divi/edit-post").updateUsedPresets({presetType:"group",presets:r})},At=(e,t)=>{if("EDIT_MODULE_ATTRIBUTE"===e.type&&"modulePreset"!==e?.attrName)return;const n=(0,g.get)(t.getState()?.asMutable({deep:!0}),"content"),r=(0,Q.populateUsedPresets)(n),o=(0,Q.populateUsedGroupPresets)(n);(0,a.dispatch)("divi/edit-post").updateUsedPresets({presetType:"module",presets:r}),(0,a.dispatch)("divi/edit-post").updateUsedPresets({presetType:"group",presets:o})};var Tt=window.jQuery,Ct=n.n(Tt);const Lt=(e,t="")=>{let n=0;const r=setInterval((()=>{const o="wireframe"===(0,a.select)("divi/app-ui").getView(),i=Ct()(`${o?".et-vb-wireframe":"divi/section"===t?".et_pb_section":"divi/row"===t||"divi/row-inner"===t?".et_pb_row":"divi/column"===t||"divi/column-inner"===t?".et_pb_column":"divi/group"===t?".et_pb_group":".et_pb_module"}[data-id="${e}"] .et-vb-add-module`);(i.length||n>1e3)&&(clearInterval(r),(0,Q.openAddModuleModal)(i,e,!0)),n+=5}),5)},Dt=["divi/portfolio","divi/blog","divi/filterable-portfolio","divi/fullwidth-portfolio"],St=(e,t)=>{if(!["EDIT_MODULE_ATTRIBUTE","EDIT_GROUP_PRESET_ATTR","REPLACE_MODULE_ATTRIBUTES"].includes(e.type))return;if("EDIT_MODULE_ATTRIBUTE"===e.type&&!e.attrName.startsWith("module.decoration.layout")&&"modulePreset"!==e.attrName)return;const n=(0,g.get)(t.getState(),["content"]),r=e.id,o=n.getIn([r,"name"]);if("divi/row"!==o&&"divi/row-inner"!==o)return;let i,l;if("REPLACE_MODULE_ATTRIBUTES"===e.type)i=(0,g.get)(e.attrs,["module","decoration","layout","desktop","value","display"]),l=(0,g.get)(e.attrs,["module","decoration","layout","desktop","value","gridColumnCount"]);else if("EDIT_MODULE_ATTRIBUTE"===e.type&&"modulePreset"===e.attrName){const t=e.value,n=(0,a.select)("divi/global-data").getModulePreset({moduleName:o,id:t});i=(0,g.get)(n,["attrs","module","decoration","layout","desktop","value","display"]),l=(0,g.get)(n,["attrs","module","decoration","layout","desktop","value","gridColumnCount"])}else if("EDIT_GROUP_PRESET_ATTR"===e.type){const{value:t}=e,{presetId:n,groupName:r}=t,o=(0,a.select)("divi/global-data").getGroupPreset({groupName:r,id:n,useDefaultFallback:!0});i=(0,g.get)(o,["attrs","module","decoration","layout","desktop","value","display"]),l=(0,g.get)(o,["attrs","module","decoration","layout","desktop","value","gridColumnCount"])}else"EDIT_MODULE_ATTRIBUTE"===e.type&&e.attrName.startsWith("module.decoration.layout")&&("module.decoration.layout.desktop.value.display"===e.attrName?(i=e.value,l=n.getIn([r,"props","attrs","module","decoration","layout","desktop","value","gridColumnCount"])):"module.decoration.layout"===e.attrName&&(i=(0,g.get)(e.value,["desktop","value","display"]),l=(0,g.get)(e.value,["desktop","value","gridColumnCount"])));if("block"!==i&&"grid"!==i)return;const s=n.getIn([r,"children"],[]),u=Array.isArray(s)?s.length:s?.asMutable?.()?.length??0;if(0!==u)if("block"===i){const t=Math.min(u,6),n=1===t?"4_4":Array(t).fill(`1_${t}`).join(",");("EDIT_GROUP_PRESET_ATTR"===e.type||"EDIT_MODULE_ATTRIBUTE"===e.type&&"modulePreset"===e.attrName)&&(0,a.dispatch)("divi/edit-post").editModuleAttribute({id:r,attrName:"module.decoration.layout.desktop.value.display",value:"block",caller:"preset",subName:"display"}),(0,a.dispatch)("divi/edit-post").changeColumnStructure(r,n)}else if("grid"===i){if(l)return;const e=n.getIn([r,"props","attrs"])?.asMutable({deep:!0})??{};if((0,g.get)(e,["module","decoration","layout","desktop","value","gridColumnCount"]))return;const t=Math.min(u,12);(0,a.dispatch)("divi/edit-post").editModuleAttribute({id:r,attrName:"module.decoration.layout.desktop.value.gridColumnCount",value:t.toString(),caller:"user",subName:"gridColumnCount"})}},Rt=(0,g.debounce)(gt,300),Pt=(0,g.debounce)(gt,500),Ut=(e,t)=>{"caller"in e&&"global-layout"===e.caller||"params"in e&&e.params&&"caller"in e.params&&"global-layout"===e.params.caller||("caller"in e&&"history"===e.caller?gt(e,t):Pt(e,t))},Nt=(0,g.debounce)(At,300),kt=(0,g.debounce)(((e,t)=>{const n=t.getState().getIn(["content"]);if(!n)return;["ADD_MODULE","REMOVE_MODULE"].includes(e.type)&&(Et=null);const r=(e=>"id"in e&&e.id?e.id:"ids"in e&&Array.isArray(e.ids)&&e.ids.length>0?e.ids[0]:null)(e);if(!r)return;if(null===Et&&(Et=(e=>Object.keys(e.asMutable({deep:!1})).some((t=>"divi/group-carousel"===e.getIn([t])?.getIn(["name"],""))))(n)),!1===Et)return;if("EDIT_MODULE_ATTRIBUTE"===e.type){if("caller"in e&&"history"===e.caller)return;if("attrName"in e&&"string"==typeof e.attrName&&!e.attrName.includes("innerContent"))return}const o=((e,t,n)=>{const r=[];let o;return(0,a.select)("divi/edit-post").getAncestorModules(e,"bottom-to-top").forEach((e=>{const i=t.getIn([e.id]);if(!i)return;const a=i.getIn(["name"],"");if("divi/group-carousel"===a&&r.push(e.id),"REMOVE_MODULE"===n&&"divi/group"===a&&!o){const n=i.getIn(["parent"],""),r=t.getIn([n])?.getIn(["name"],"");"divi/group-carousel"===r&&(o=e.id)}})),{affectedCarousels:r,slideGroupId:o}})(r,n,e.type);if(0===o.affectedCarousels.length)return;const i=o.slideGroupId||r;_t(o.affectedCarousels,i)}),300),wt=(e,t)=>{if("user"===e.caller){const n=e.name;0===(0,a.select)("divi/module").getModuleCount().getIn([n,"total"],0)?At(e,t):Nt(e,t)}else At(e,t)},Gt={ADD_COLUMN_VIA_DIVIDER:[vt,Nt,ne,ft,gt],ADD_FLEX_COLUMN_VIA_DIVIDER:[vt,Nt,ne,ft,gt],ADD_MODULE:[(e,t)=>{const n=(0,g.get)(e,"name"),r=(0,g.get)(e,"position");if("divi/section"===n&&"after"===r){const r=(0,g.get)(e,"id"),o=(0,g.get)(t.getState(),"content").getIn(["root","children"]),i=o.indexOf(r),a=o[i+1];Lt(a,n)}},(e,t)=>{const n=(0,g.get)(e,"name"),r=(0,a.select)("divi/module-library").getModuleCategory(n);if(!(0,g.includes)(["module","fullwidth-module"],r))return;const o=(0,a.select)("divi/module-library").getChildModules({moduleName:n});if((0,g.isEmpty)(o))return;const i=(0,a.select)("divi/app-preferences").get(["module","dummyContent"]),l=(0,g.get)(t.getState(),"content"),s=(0,g.get)(e,"id"),u=(0,g.get)(e,"position"),d="inside"===u?s:(0,g.get)(l,[s,"parent"]),c=l.getIn([d,"children"],[]).asMutable(),p="inside"===u?(0,g.last)(c):c[c.indexOf(s)+("before"===u?-1:1)],m=(0,a.select)("divi/module-library").getModule(n);m.template&&m.template.forEach((e=>{const t=e[0],r=(0,g.isString)(e[1])?{}:e[1],o=(0,a.select)("divi/module-library").getModule(t),l=(0,a.select)("divi/settings").getSetting(["builderVersion"]),s=i&&o?.placeholderContent?o?.placeholderContent:{};if((0,g.includes)(o.parentsName,n)||"divi/group-carousel"===n&&"divi/group"===t){const e={attrs:(0,g.merge)({},s,r,{builderVersion:l})};(0,a.dispatch)("divi/edit-post").addModule(p,t,e,"inside")}}))},vt,wt,kt,ne,ft,Rt],ADD_MODULE_GROUP:[e=>{Lt(e.id,"divi/group")}],ADD_ROW:[(e,t)=>{const n=(0,g.get)(t.getState(),"content"),r=(0,g.get)(e,"id"),o=(0,g.get)(e,"position"),i="inside"===o?r:(0,g.get)(n,[r,"parent"]),a=n.getIn([i,"children"],[]).asMutable(),l="inside"===o?(0,g.last)(a):a[a.indexOf(r)+("before"===o?-1:1)],s=(0,g.get)(n,l),u=(0,g.head)((0,g.get)(s,"children")),d="divi/row-inner"===(0,g.get)(n,[l,"name"])?"divi/column-inner":"divi/column";Lt(u,d)},vt,Nt,ne,ft,gt],ADD_GRID:[(e,t)=>{const{id:n,position:r,isAddSection:o}=e,i=(0,g.get)(t.getState(),"content");if(o&&"after"===r){const e=i.getIn(["root","children"]),t=e[e.indexOf(n)+1],r=(0,g.head)((0,g.get)(i,[t,"children"])),o=(0,g.head)((0,g.get)(i,[r,"children"]));return void(o&&Lt(o,"divi/column"))}const a="inside"===r?n:(0,g.get)(i,[n,"parent"]),l=i.getIn([a,"children"],[]).asMutable(),s="inside"===r?(0,g.last)(l):l[l.indexOf(n)+("before"===r?-1:1)],u=(0,g.head)((0,g.get)(i,[s,"children"])),d="divi/row-inner"===(0,g.get)(i,[s,"name"])?"divi/column-inner":"divi/column";if(u){const e=(0,g.get)(i,s),t=(0,g.get)(e,["props","attrs","module","advanced","flexColumnStructure","desktop","value"],"");if("string"==typeof t&&t.startsWith("multi-column-grids_")){const e=(0,g.get)(i,u),t=(0,g.get)(e,"children",[]),n=(0,g.head)(t);if(n){const e=(0,g.get)(i,n),t=(0,g.get)(e,"children",[]),r=(0,g.head)(t);r?Lt(r,"divi/column"):Lt(n,"divi/row")}else Lt(u,d)}else Lt(u,d)}},(e,t)=>{const{id:n,position:r,isAddSection:o}=e,i=t.getState()?.content;let l=null;if(o&&"after"===r){const e=i?.getIn(["root","children"])?.asMutable();if(e&&Array.isArray(e)){const t=e.indexOf(n);if(-1!==t){const n=t+1;if(n<e.length){const t=e[n];if("string"==typeof t){const e=(0,g.head)((0,g.get)(i,[t,"children"]));e&&(l=e)}}}}}else if(!o){const e="inside"===r?n:(0,g.get)(i,[n,"parent"]),t=i?.getIn([e,"children"]),o=t?.asMutable?t.asMutable():null;if(o&&Array.isArray(o)){const e="inside"===r?(0,g.last)(o):(()=>{const e=o.indexOf(n);if(-1===e)return null;const t=e+("before"===r?-1:1);return t<0||t>=o.length?null:o[t]})();e&&(l=e)}}l&&(0,a.dispatch)("divi/modal-library").open({name:"divi/module",owner:l})},vt,Nt,ne,ft,gt],ADD_SPECIALTY_SECTION:[(e,t)=>{const n=(0,g.get)(e,["innerPosition"]).split(",").indexOf("1"),r=(0,g.get)(e,"id"),o=(0,g.get)(t.getState(),"content"),i=o.getIn(["root","children"]),a=i.indexOf(r),l=i["after"===(0,g.get)(e,"position")?a+1:a-1],s=o.getIn([l,"children"])[n];Lt(s,"divi/column")},ne,ft,gt],CHANGE_COLUMN_STRUCTURE:[vt,Nt,kt,ne,ft,gt],CHANGE_FLEX_COLUMN_STRUCTURE:[(e,t)=>{if("CHANGE_FLEX_COLUMN_STRUCTURE"!==e.type)return;const{id:n,breakpoint:r,state:o}=e,i=(0,g.get)(t.getState(),["content"]).getIn([n,"name"],"");"divi/row"===i||"divi/row-inner"===i||(0,a.dispatch)("divi/edit-post").editModuleAttribute({id:n,attrName:`module.decoration.layout.${r}.${o}.flexDirection`,value:"row",subName:"flexDirection"})},vt,Nt,kt,ne,ft,gt],CHANGE_GRID_COLUMN_STRUCTURE:[vt,Nt,kt,ne,ft,gt],CLEAR_LAYOUT:[(e,t)=>{const n=(0,g.get)(t.getState(),"content").getIn(["root","children",0]);Lt(n,"divi/section")},Nt,ne,gt],CLONE_MODULE:[vt,Nt,kt,ne,gt],CLONE_COLUMN:[vt,ne,ft,gt,kt],CLONE_FLEX_COLUMN:[vt,ne,ft,gt,kt],CONVERT_SELECTED_MODULES_TO_GROUP:[(e,t)=>{const n=t.getState().content,{selectedModuleIds:r}=e,o=(0,g.get)(n,[r[0],"parent"],"");(0,a.dispatch)("divi/modal-library").open({name:"divi/module",owner:o})},ne,ft,Rt],COPY_MODULE:[vt,Nt,ne,ft],COPY_MODULE_FROM_PAYLOAD:[vt,Nt,ne,ft,gt],COPY_MODULES_FROM_PAYLOAD:[vt,Nt,ne,ft,gt],COPY_MODULE_FROM_LIBRARY:[e=>{if("global"!==e.payload.getIn(["is_global"]))return;const t=String(e.payload.getIn(["ID"])),n=(0,a.select)("divi/global-layouts").getLayout(t);let r;if(n)r=n.getIn(["content"])?.asMutable({deep:!0});else{const t=(0,Q.maybeUnwrapPlaceholderBlock)(e.payload.getIn(["content"],"")),n=(0,Q.maybeUnwrapPlaceholderBlock)(t);r=H(n)}const o=(0,a.select)("divi/edit-post").getContent(),{position:i,targetId:l}=e;let s;if("inside"===i){const e=o.getIn([l,"children"],[])?.asMutable({deep:!0})??[];s=e[e.length-1]}else if("before"===i||"after"===i){const e=o.getIn([l,"parent"]),t=o.getIn([e,"children"],[])?.asMutable({deep:!0})??[],n=t.indexOf(l);s="before"===i?t[n-1]:t[n+1]}if(!s)return;const u=o.getIn([s,"props","attrs"])?.globalModule;if(u!==t)return;(n?.getIn(["owners"],[])?.asMutable({deep:!0})??[]).includes(s)||(0,a.dispatch)("divi/global-layouts").setLayoutContent({templateId:t,content:r,instanceId:s,syncToServer:!1})},At,ne],EDIT_CHILDREN:[vt,Rt],EDIT_MODULE_ATTRIBUTE:[(e,t)=>{if("EDIT_MODULE_ATTRIBUTE"!==e.type)return;if("portfolio.advanced.layout"!==e.attrName&&"fullwidth.advanced.enable"!==e.attrName)return;const n=(0,g.get)(e.value,"desktop.value","");if(!("grid"===n||"off"===n))return;const r=e.id,o=(0,g.get)(t.getState(),["content"]).getIn([r,"name"],"");if(!Dt.includes(o))return;const i=(e=>{const t=(0,a.select)("divi/module-library").getModule(e)?.defaultAttrs;if(!t)return null;let n={},r="";return"divi/portfolio"===e||"divi/filterable-portfolio"===e||"divi/fullwidth-portfolio"===e?(n=(0,g.get)(t,"portfolioGrid.advanced.flexType",{}),r="portfolioGrid"):"divi/blog"===e&&(n=(0,g.get)(t,"blogGrid.advanced.flexType",{}),r="blogGrid"),Object.keys(n).length?{defaults:n,attrPath:r}:null})(o);if(!i)return;const{defaults:l,attrPath:s}=i;Object.entries(l).forEach((([e,t])=>{const n=(0,g.get)(t,"value");n&&(0,a.dispatch)("divi/edit-post").editModuleAttribute({id:r,attrName:`${s}.advanced.flexType.${e}.value`,value:n,caller:"user",subName:!1})}))},vt,At,kt,ft,Ut,St],EDIT_MODULE_PROP:[vt,At,ft,Ut],EDIT_LOCAL_ATTRS_MAP:[vt,Nt,ft,gt],EDIT_LOCAL_CHILDREN:[vt,Nt,ft,gt],IMPORT_CONTENT:[e=>{if("on"!==e?.importOptionsValues?.replaceLayout)return;(0,a.select)("divi/modal-library").getModal("divi/module")&&setTimeout((()=>{const e=(0,a.select)("divi/edit-post").getRootModuleIds()[0];(0,a.dispatch)("divi/modal-library").open({name:"divi/module",owner:e})}),0)},e=>{if("on"!==e?.importOptionsValues?.replaceLayout)return;if(!(0,a.select)("divi/modal-library").getModal("divi/inspector"))return;(0,a.select)("divi/modal-library").getModalProperty({modalName:"divi/inspector",property:"owner"})&&setTimeout((()=>{(0,a.dispatch)("divi/modal-library").open({name:"divi/inspector",owner:""})}),0)},Nt,ne,gt],MERGE_GLOBAL_MODULES:[At,ne],MOVE_MODULE:[vt,Nt,kt,ft,gt,(e,t)=>{const{draggedModuleParentId:n,targetParentId:r,id:o}=e;if(n===r)return;const i=(0,g.get)(t.getState(),["content"]),l=i.getIn([o,"name"]);if("divi/column"!==l&&"divi/column-inner"!==l)return;const s=i.getIn([r,"props","attrs","module","advanced","columnStructure","desktop","value"],"").split(",").length??0,u="block"!==i.getIn([r,"props","attrs","module","decoration","layout","desktop","value","display"],""),d="block"!==i.getIn([n,"props","attrs","module","decoration","layout","desktop","value","display"],"");if(s>={"divi/column":6,"divi/column-inner":3}[l]&&!u)return c=(0,mt.__)("This number of columns cannot be used on this row.","et_builder"),void(0,g.get)(window,"alert",g.noop)(c);var c;u||d?(0,a.dispatch)("divi/edit-post").changeFlexColumnStructureForDragAndDrop({id:o,parentRowId:r,targetRowColumnStructure:u?"flex":"block"}):(0,a.dispatch)("divi/edit-post").changeColumnStructureForDragAndDrop(n,r)}],MOVE_MODULES:[vt,Nt,kt,ft,gt],REMOVE_COLUMN:[vt,Nt,kt,ft,yt,ne,gt],REMOVE_MODULE:[vt,Nt,kt,ft,yt,ne,gt],REMOVE_MODULE_ATTRIBUTE:[vt,Nt,kt,ft,gt],REMOVE_GROUP_PRESET_ATTRIBUTE:[Ot],REPLACE_MODULE_ATTRIBUTES:[vt,Nt,St,kt,ft,gt],SET_LAYOUT_STATE:[Nt,ne],SYNC_GLOBAL_MODULE_ATTRIBUTES:[ft],SYNC_MODULE_GLOBAL_COLORS:[(e,t)=>{const n=t.getState().content,r=JSON.stringify({...n}),o=new RegExp('"var[(]--(?:gcid-([0-9a-z-]*))[)]"',"gi"),i=(0,g.uniq)(Array.from(r.matchAll(o)).map((e=>e[1])));if(i.length>0){const e=Number((0,a.select)("divi/settings").getSetting(["post","id"]));e&&(0,a.dispatch)("divi/global-data").updateGlobalColorsUsedInPosts(e,i)}},ft],EDIT_GROUP_PRESET_ATTR:[vt,Ot,St,ft,Ut],ADD_MODULE_PRESET_TO_STACK:[It,At,ft,Ut],REMOVE_MODULE_PRESET_FROM_STACK:[At,ft,Ut],REPLACE_MODULE_PRESET_IN_STACK:[It,At,ft,Ut],ADD_GROUP_PRESET_TO_STACK:[Ot,ft,Ut],REMOVE_GROUP_PRESET_FROM_STACK:[Ot,ft,Ut],REPLACE_GROUP_PRESET_IN_STACK:[Ot,ft,Ut]},Vt=()=>e=>t=>{if((0,a.select)("divi/global-data").isActivePreset()||"attrName"in t&&"modulePreset"===t.attrName){return e(t)}let n,r,o,i=!1;if("EDIT_LOCAL_CHILDREN"===t.type){if(n=t.params?.id,r=(0,a.select)("divi/edit-post").getGlobalLayoutId(n),o=!!r,o){i=(0,a.select)("divi/edit-post").getModuleAttr(n,"localChildren")!==!t.params.isSynced}}else if(n=t.id,r=(0,a.select)("divi/edit-post").getGlobalLayoutId(n),o=!!r,o&&"attrName"in t&&t.attrName){const e=t.attrName,r=(0,a.select)("divi/edit-post").getModuleAttr(n,e);i=!(0,g.isEqual)((0,g.cloneDeep)(t.value),(0,g.cloneDeep)(r))}if(!o){return e(t)}const l=(0,a.select)("divi/global-layouts").getLayout(r)?.preEditContent,s=!!l,u=(0,a.select)("divi/edit-post").getModuleAttrs(n);!s&&i&&((0,a.dispatch)("divi/history").disableHistoryTracking(),(0,a.dispatch)("divi/global-layouts").setPreEditContent({id:r,content:u}));return e(t)},Ft=({action:e,globalInstanceId:t,moduleId:n})=>{if(t===n&&"ADD_MODULE"===e.type&&["before","after"].includes(e?.position))return!1;if("EDIT_LOCAL_ATTRS_MAP"===e.type||"EDIT_LOCAL_CHILDREN"===e.type)return!0;if("EDIT_MODULE_ATTRIBUTE"===e.type){const r=e.attrName,o=(0,a.select)("divi/edit-post").getModuleAttr(n,"globalParent",""),i=(0,a.select)("divi/edit-post").getModuleAttr(n,"globalModule","");if(o&&!i){return!(0,a.select)("divi/edit-post").getModuleAttr(t,"localChildren",!1)}const l=(0,a.select)("divi/edit-post").getModuleAttr(n,"localAttrsMap",[]);if(!Array.isArray(l)||0===l.length)return!0;const s=r.split(".");return!l.some((t=>{const n=t.attrName.split("."),r=s.slice(0,n.length).join(".")===t.attrName;if(t.subName){if("subName"in e&&e.subName)return!!r&&e.subName===t.subName;if(r){if("object"==typeof e.value&&e.value&&!Array.isArray(e.value)){const n=e.value;return Object.values(n).some((e=>"object"==typeof e&&null!==e&&!Array.isArray(e)&&Object.values(e).some((e=>{return"object"==typeof e&&null!==e&&!Array.isArray(e)&&(n=e,t.subName.split(".").reduce(((e,t)=>e.exists?"object"!=typeof e.current||null===e.current||Array.isArray(e.current)||!Object.prototype.hasOwnProperty.call(e.current,t)?{current:null,exists:!1}:{current:e.current[t],exists:!0}:e),{current:n,exists:!0}).exists);var n}))))}const r=s.slice(n.length).join(".");if(r===t.subName||r.endsWith(`.${t.subName}`))return!0}return!1}return r}))}if(e.type.includes("CHILDREN")||"MOVE_MODULE"===e.type||"ADD_MODULE"===e.type||"REMOVE_MODULE"===e.type){let n=t;if("id"in e&&e.id){const t=(0,a.select)("divi/edit-post").getModuleAttr(e.id,"globalParent",""),r=(0,a.select)("divi/edit-post").getModuleAttr(e.id,"globalModule","");t&&!r||(n=e.id)}return!(0,a.select)("divi/edit-post").getModuleAttr(n,"localChildren",!1)}return!0},xt=()=>e=>t=>{if("caller"in t&&"global-layout"===t.caller)return e(t);if("EDIT_MODULE_ATTRIBUTE"===t.type){const n=t?.id,r=t?.attrName;if(n&&r){const o=(0,a.select)("divi/edit-post").getModuleAttr(n,r),i=t?.value,l=(0,Q.isImmutableObject)(o)?o.asMutable({deep:!0}):o;if((0,g.isEqual)(l,i))return e(t)}}const n=e(t);let r;if("owner"in t?r=t.owner:"id"in t?r=t.id:"params"in t&&"id"in t.params&&(r=t.params.id),r){let e=(0,a.select)("divi/edit-post").getGlobalLayoutId(r),n=r;const o=(0,a.select)("divi/edit-post").getModuleAttr(r,"globalParent",""),i=(0,a.select)("divi/edit-post").getModuleAttr(r,"globalModule","");if(o&&!i){let t=r;for(;t;){const r=(0,a.select)("divi/edit-post").getParentModule(t);if(!r)break;const i=(0,a.select)("divi/edit-post").getModuleAttr(r.id,"globalModule");if(i===o){e=i,n=r.id;break}t=r.id}}e&&Ft({action:t,globalInstanceId:n,moduleId:r})&&(0,a.dispatch)("divi/global-layouts").addSyncWorthyChange({instanceId:n,templateId:e,action:t})}return n},Bt=()=>e=>t=>{if(["CLEAR_LAYOUT","ADD_ROW","MOVE_MODULES","ADD_GRID","CHANGE_COLUMN_STRUCTURE","ADD_COLUMN_VIA_DIVIDER","ADD_FLEX_COLUMN_VIA_DIVIDER","REMOVE_MODULE"].includes(t.type)){const e=(0,a.select)("divi/settings").getSetting(["builderVersion"]);t={...t,builderVersion:e}}return e(t)},jt={ADD_COLUMN_VIA_DIVIDER:[Bt],ADD_MODULE:[xt],ADD_ROW:[Bt],ADD_FLEX_COLUMN_VIA_DIVIDER:[Bt],CHANGE_COLUMN_STRUCTURE:[xt,()=>e=>t=>{const n=(0,a.select)("divi/edit-post").getContent().getIn([t.id])?.props?.attrs?.module?.advanced?.columnStructure?.desktop?.value??"";t.columnStructureOrigin=n;return e(t)},Bt],CHANGE_FLEX_COLUMN_STRUCTURE:[xt,Bt],CHANGE_GRID_COLUMN_STRUCTURE:[xt,Bt],CLEAR_LAYOUT:[Bt],ADD_GRID:[Bt],EDIT_CHILDREN:[xt],EDIT_MODULE_ATTRIBUTE:[Vt,xt,()=>e=>t=>{(0,a.select)("divi/global-data").isActivePreset()&&"preset"!==t.caller&&(0,a.dispatch)("divi/global-data").closePresetModal();return e(t)}],EDIT_LOCAL_ATTRS_MAP:[()=>e=>t=>{if("EDIT_LOCAL_ATTRS_MAP"!==t.type){return e(t)}const n=t.id,r=(0,a.select)("divi/edit-post").getGlobalLayoutId(n);if(!!!r){return e(t)}const o=(0,a.select)("divi/global-layouts").getLayout(r)?.preEditContent;if(!!!o){const e=(0,a.select)("divi/edit-post").getModuleAttrs(n);(0,a.dispatch)("divi/global-layouts").setPreEditContent({id:r,content:e.asMutable()})}return e(t)},xt],EDIT_LOCAL_CHILDREN:[Vt,xt],MOVE_MODULE:[xt,()=>e=>t=>{const n=(0,a.select)("divi/edit-post").getContent(),r=n.getIn([t.id,"parent"]),o="inside"===t.position?t.targetId:n.getIn([t.targetId,"parent"]);t.draggedModuleParentId=r,t.targetParentId=o;return e(t)}],MOVE_MODULES:[xt,Bt],REMOVE_MODULE:[xt,Bt],REVERT_GLOBAL_MODULE_EDIT_STATE:[()=>e=>t=>{const{owner:n}=t,r=t.id,o=(0,a.select)("divi/global-layouts").getLayout(r)?.preEditContent?.asMutable();if(o){const e=(0,g.omit)(o,["modulePreset"]);e.localAttrsMap||(e.localAttrsMap=[]);const l=(0,a.select)("divi/edit-post").getModuleAttrs(n)?.asMutable({deep:!0}),s=(0,Q.flattenAttrs)(l||{}),u=(0,Q.flattenAttrs)(e),d=[];Object.keys(s).forEach((e=>{e in u||d.push(e)})),(0,a.dispatch)("divi/edit-post").replaceModuleAttributes(n,i()(e),"global-layout",!1),d.forEach((e=>{(0,a.dispatch)("divi/edit-post").removeModuleAttribute(n,e)}));const c=(0,a.select)("divi/edit-post").getModuleAttrs(n)?.globalModule;if(c===r){const o=(0,a.select)("divi/edit-post").getGlobalLayoutOwners(r)?.asMutable({deep:!0}),l=n;o.forEach((t=>{if(t===l)return;const n=(0,a.select)("divi/edit-post").getModuleAttrs(t)?.localAttrsMap||[];(0,a.dispatch)("divi/edit-post").syncGlobalLayoutAttributes(t,i()(e),n)}));const s=(0,a.select)("divi/edit-post").getModuleWithChildren(n);(0,a.dispatch)("divi/global-layouts").setLayoutContent({templateId:r,content:s,instanceId:n,syncToServer:!1,sourceAction:{store:"divi/edit-post",action:t.type}})}}return(0,a.dispatch)("divi/global-layouts").deletePreEditContent({id:r}),(0,a.dispatch)("divi/global-layouts").clearSyncWorthyChanges(),(0,a.dispatch)("divi/history").enableHistoryTracking(),e(t)}]},Yt=(e,t,n,r,o="after",i="")=>{const a=e.getIn([t,"parent"],""),l="inside"===o?t:a,s=i||b(),u=e.getIn([a,"props","attrs","globalModule"],!1),d=e.getIn([a,"props","attrs","globalParent"],!1),c=u||d||!1,m=(0,v.applyFilters)("divi.addModule.attrs",r?.attrs,{state:e.asMutable({deep:!0}),name:n,id:s,parentId:l}),f={id:s,children:[],name:n,parent:l,props:(0,g.isEmpty)(m)?r:{...r,attrs:{...m}}};let I=e.getIn([l,"children"])?.asMutable();Array.isArray(I)||(I=[]);const y="inside"===o?(0,g.isArray)(I)?[...I,f.id]:[f.id]:p(f.id,t,I,o);return e=e.merge({[f.id]:f}).setIn([l,"children"],y),c?e.setIn([f.id,"props","attrs","globalParent"],c):e},$t=(e,t,n,r="postContent")=>{const o=e.getIn(["content"]),i=o.getIn([t],{});if((0,g.isEmpty)(i))return e;const a=i.getIn(["parent"]),l=o.getIn([a,"children"],[]).asMutable(),s=l.indexOf(t);if(s<0)return e;const u=[...l];if(u.splice(s,1),"root"===a&&0===u.length){const t=b(),r=o.setIn([a,"children"],[t]).setIn([t],{id:t,name:"divi/section",children:[],parent:"root",props:{attrs:{builderVersion:n}}});return e.setIn(["content"],r)}const d=o.setIn([a,"children"],u),c=((e,t)=>{const n=t.getIn(["content"]),r=n.getIn([e]);if(!r)return t;const o=r.getIn(["props","attrs","module","advanced","loop"],null);if(!o)return t;const i="on"===o.getIn(["desktop","value","enable"]),a=o.getIn(["desktop","value","loopId"],"");if(!i||!(0,g.isString)(a))return t;let l=n,s=!1;return Object.keys(n).forEach((e=>{const t=n[e];if("divi/post-nav"!==t.getIn(["name"]))return;const r=t.getIn(["props","attrs","module","advanced","targetLoop"],null);if(!r)return;const o=r.getIn(["desktop","value"],"");(0,g.isString)(a)&&o===a&&(l=l.setIn([e,"props","attrs","module","advanced","targetLoop","desktop","value"],"main_query"),s=!0)})),s?t.setIn(["content"],l):t})(t,e.setIn(["content"],d).setIn(["layouts",r,"removedModules",t],{id:t,timestamp:Date.now()}));return c},Ht=(e,t,n,r)=>{let o=e.getIn(["content"]);const i=o.getIn([t,"children"],[]),a=n.split(","),l=(0,g.isArray)(i)?i.length:0,s=a.length,u="divi/row-inner"===o.getIn([t,"name"])?"divi/column-inner":"divi/column";if(o=o.setIn([t,"props","attrs","module","advanced","columnStructure","desktop","value"],n),l>s){const t=l-s,n=i.slice(0-t),r=i[s-1];(0,g.forEach)(n,(t=>{const n=o.getIn([t,"children"],[]),i=o.getIn([r,"children"],[]).concat(n);(0,g.forEach)(n,(e=>{o=o.setIn([e,"parent"],r)})),o=o.setIn([r,"children"],i),o=o.setIn([t,"children"],[]),o=$t(e.setIn(["content"],o),t).getIn(["content"])}))}else if(l<s){const e=s-l;(0,g.forEach)(a.slice(0-e),(e=>{o=Yt(o,t,u,{attrs:{builderVersion:r,module:{advanced:{type:{desktop:{value:e}}}}}},"inside")}))}return(0,g.forEach)(i,((e,t)=>{o=a[t]?o.setIn([e,"props","attrs","module","advanced","type","desktop","value"],a[t]):o.without(e)})),e.setIn(["content"],o)};var zt=window.divi.constantLibrary;const Wt=(e,t,n,r,o="user")=>{const a=e.getIn([t,"props","attrs"],i()({})),l=n.split("."),s=l.length>1,u=s?l[0]:n,d=s?a.getIn([u],i()({})).setIn((0,g.tail)(l),r):r,c=e.getIn([t,"props","attrs","localAttrsMap"])?.asMutable();if("global-layout"===o){if(Array.isArray(c)&&c.some((e=>e?.attrName===n)))return e}return e.setIn([t,"props","attrs",u],d)},Kt=(e,t,n)=>{const r=n.split("."),o=r[0],i=r.length>1,a=e.getIn([t,"props","attrs"]);if(i){const n=(0,g.last)(r),i=(0,g.slice)(r,0,r.length-1),l=a.getIn(i);if(l){const r=(e=e.setIn([t,"props","attrs"].concat(i),l.without(n))).getIn([t,"props","attrs"]),a=r.getIn([o]),s=(0,Q.removeEmptyObjectRecursive)(a?.asMutable({deep:!0}));(0,g.isEmpty)(s)?e=e.setIn([t,"props","attrs"],r.without(o)):(0,g.isEqual)(s,a?.asMutable({deep:!0}))||(e=e.setIn([t,"props","attrs",o],s))}return e}return e.setIn([t,"props","attrs"],a.without(n))},Xt=(e,t,n,r)=>{if(!t.template)return[];return e.map(((e,o)=>{const i=o%t.template.length;return{columnId:e,flexType:(0,Q.getAttrValue)({attr:t.template[i].flexTypeAttr,breakpoint:n,state:r,mode:"getAndInheritAll",baseBreakpoint:"desktop",breakpointNames:Q.defaultBreakpointNames})??null}}))},qt=(e,{breakpointName:t,attrState:n,rowId:r,flexColumnStructureValue:o,flexWrapValue:i,columnsData:a})=>{let l=e.getIn(["content"]);l=Wt(l,r,`module.decoration.layout.${t}.${n}.display`,"flex");return["gridColumnWidths","gridColumnCount","gridRowHeights","gridTemplateColumns","gridTemplateRows","gridAutoRows","gridAutoColumns","gridAutoFlow"].forEach((e=>{l=Kt(l,r,`module.decoration.layout.${t}.${n}.${e}`)})),null!==o&&(l=Wt(l,r,`module.advanced.flexColumnStructure.${t}.${n}`,o)),null!==i&&(l=Wt(l,r,`module.decoration.layout.${t}.${n}.flexWrap`,i)),null!==o&&(l=Kt(l,r,`module.decoration.layout.${t}.${n}.flexDirection`)),null!==o&&(l=Kt(l,r,`module.decoration.layout.${t}.${n}.alignContent`)),a.forEach((({columnId:e,flexType:r})=>{null!==r&&r.flexType&&(l=Wt(l,e,`module.decoration.sizing.${t}.${n}.flexType`,r.flexType))})),e.setIn(["content"],l)},Jt=(e,t)=>"desktop"===t.breakpoint&&"value"===t.state?((e,t)=>{const{id:n,value:r,breakpoint:i,state:a}=t,l=(0,Q.getPremadeGrid)(r);if(!l)return e;const s=e.getIn(["content",n],null);if(!s)return e;const u=(0,o.asMutable)(s.getIn(["children"],[])),d=(()=>{const e=s.getIn(["props","attrs","module","advanced","flexColumnStructure"],null);if(e&&e.desktop?.value)return e;const t=s.getIn(["props","attrs","module","advanced","columnStructure","desktop","value"],null);if(t){const e=t.split(",").length;return{desktop:{value:(0,Q.newFlexColumnStructure)(e)}}}return{desktop:{value:"equal-columns_1"}}})();if(d.phone||(e=qt(e,{breakpointName:"phone",attrState:"value",rowId:n,flexColumnStructureValue:null,flexWrapValue:l.layoutAttr?.phone?.value?.flexWrap??null,columnsData:Xt(u,l,"phone","value")})),!d.phoneWide){const t=l.layoutAttr?.phoneWide?.value?.flexWrap??l.layoutAttr?.phone?.value?.flexWrap??null;e=qt(e,{breakpointName:"phoneWide",attrState:"value",rowId:n,flexColumnStructureValue:null,flexWrapValue:t,columnsData:Xt(u,l,"phone","value")})}if(d.tablet||(e=qt(e,{breakpointName:"tablet",attrState:"value",rowId:n,flexColumnStructureValue:null,flexWrapValue:l.layoutAttr?.tablet?.value?.flexWrap??null,columnsData:Xt(u,l,"tablet","value")})),!d.tabletWide){const t=l.layoutAttr?.tabletWide?.value?.flexWrap??l.layoutAttr?.tablet?.value?.flexWrap??null;e=qt(e,{breakpointName:"tabletWide",attrState:"value",rowId:n,flexColumnStructureValue:null,flexWrapValue:t,columnsData:Xt(u,l,"tablet","value")})}return qt(e,{breakpointName:i,attrState:a,rowId:n,flexColumnStructureValue:r,flexWrapValue:l.layoutAttr?.desktop?.value?.flexWrap??null,columnsData:Xt(u,l,"desktop","value")})})(e,t):((e,t)=>{const{id:n,value:r,breakpoint:i,state:a}=t,l=(0,Q.getPremadeGrid)(r);if(!l)return e;const s=zt.flexWrapRowBreakpoints.includes(i)?"wrap":"nowrap",u=(0,o.asMutable)(e.getIn(["content",n,"children"],[])).map(((e,t)=>{const n=t%l.template.length;return{columnId:e,flexType:l.template[n].flexTypeAttr?.desktop?.value??null}}));return qt(e,{breakpointName:i,attrState:a,rowId:n,flexColumnStructureValue:r,flexWrapValue:s,columnsData:u})})(e,t),Qt=(e,{rowId:t,breakpoint:n,state:r="value",isInherit:o=!1})=>{let i=e.getIn(["content"]);const a=i.getIn([t,"children"],[]);if(i=Kt(i,t,`module.advanced.flexColumnStructure.${n}.${r}`),i=Kt(i,t,`module.decoration.layout.${n}.${r}.flexWrap`),a.forEach((e=>{i=Kt(i,e,`module.decoration.sizing.${n}.${r}.flexType`)})),e=e.setIn(["content"],i),o){const o=i.getIn([t,"props","attrs","module","advanced","flexColumnStructure","desktop","value"],null);o&&(e=Jt(e,{id:t,breakpoint:n,state:r,value:o}))}return e},Zt=(e,t,n,r,o,i)=>{if(!e.getIn([t]))return e;const a=i||(0,Q.getPremadeGrid)(r);if(!a)return e;const l=a?.template,s="inside"===n?t:e.getIn([t]).parent,u=e.getIn([s])?.children,d=e.getIn([s,"props","attrs","globalModule"],!1),c=e.getIn([s,"props","attrs","globalParent"],!1),m=d||c||!1,f=b(),I={id:f,name:"divi/row",children:[],parent:s,props:{attrs:(()=>{const e={advanced:{flexColumnStructure:{desktop:{value:r}}}};return a.layoutAttr?{builderVersion:o,module:{...e,decoration:{layout:{...a.layoutAttr}}}}:{builderVersion:o,module:e}})()}},y="inside"===n?(0,g.isArray)(u)?[...u,f]:[f]:p(f,t,u.asMutable(),n);return e=e.merge({[f]:I}).setIn([s,"children"],y),m&&(e=e.setIn([f,"props","attrs","globalParent"],m)),l.forEach((t=>{switch(t.type){case"column":{const n=b(),r={id:n,name:"divi/column",parent:f,props:{attrs:{builderVersion:o,module:{decoration:{sizing:t.flexTypeAttr?{...t.flexTypeAttr}:{}}}}},children:[]},i=e.getIn([f,"children"]),l=(0,g.isArray)(i)?[...i,n]:[n];e=e.merge({[n]:r}).setIn([f,"children"],l),m&&(e=e.setIn([n,"props","attrs","globalParent"],m)),t.children&&t.children.forEach((t=>{e=Zt(e,n,"inside",t.columnStructure,o,{...a,name:t.columnStructure,layoutAttr:t.layoutAttr,template:t.children})}));break}}})),e},en=(e,{id:t,position:n,template:r,isAddSection:o,builderVersion:a})=>!0===o?((e,t,n,r,o)=>{if(!e.getIn([t]))return e;const a=e.getIn(["root","children"]),l=b(),s=i()({id:l,name:"divi/section",parent:"root",children:[],props:{attrs:{builderVersion:o}}}),u=p(l,t,a.asMutable(),n);return e=e.merge({[l]:s}).setIn(["root","children"],u),Zt(e,l,"inside",r,o)})(e,t,n,r,a):Zt(e,t,n,r,a),tn=(e,t,n,r,o,i=!1,a="")=>{const l=e.getIn([t]).parent,s="inside"===n?t:l,u=e.getIn([s])?.children,d=i?"divi/row-inner":"divi/row",c=e.getIn([s,"props","attrs","globalModule"],!1),m=e.getIn([s,"props","attrs","globalParent"],!1),f=c||m||!1,I=a||b(),y={id:I,name:d,children:[],parent:s,props:{attrs:{builderVersion:o,module:{advanced:{columnStructure:{desktop:{value:r}}},decoration:{layout:{desktop:{value:{display:"block"}}}}},...f&&{globalParent:f}}}},E="inside"===n?(0,g.isArray)(u)?[...u,I]:[I]:p(I,t,u.asMutable(),n);e=e.merge({[I]:y}).setIn([s,"children"],E);const _=r.split(","),h=_.length,M={};for(let e=0;e<h;e++){const t=b();M[t]={id:t,name:i?"divi/column-inner":"divi/column",parent:I,props:{attrs:{builderVersion:o,module:{advanced:{type:{desktop:{value:_[e]}}},decoration:{layout:{desktop:{value:{display:"block"}}}}}}},children:[]}}return f&&(e=e.setIn([y.id,"props","attrs","globalParent"],f)),e.merge(M).setIn([I,"children"],(0,g.keys)(M))},nn=(e,t)=>{const{id:n,value:r,breakpoint:i,state:a}=t,l=(0,Q.getPremadeGrid)(r);if(!l)return e;const s=e.getIn(["content",n],null);if(!s)return e;const u=zt.flexWrapRowBreakpoints.includes(i)?"wrap":"nowrap",d=(0,o.asMutable)(s.getIn(["children"],[])).map(((e,t)=>{const n=t%l.template.length;return{pricingTableId:e,flexType:(0,Q.getAttrValue)({attr:l.template[n].flexTypeAttr,breakpoint:i,state:a,mode:"getAndInheritAll",baseBreakpoint:"desktop",breakpointNames:Q.defaultBreakpointNames})??null}}));return((e,{breakpointName:t,attrState:n,pricingTablesId:r,flexColumnStructureValue:o,flexWrapValue:i,pricingTablesData:a})=>{let l=e.getIn(["content"]);return null!==o&&(l=Wt(l,r,`module.advanced.flexColumnStructure.${t}.${n}`,o)),null!==i&&(l=Wt(l,r,`module.decoration.layout.${t}.${n}.flexWrap`,i)),a.forEach((({pricingTableId:e,flexType:r})=>{null!==r&&r.flexType&&(l=Wt(l,e,`module.decoration.sizing.${t}.${n}.flexType`,r.flexType))})),e.setIn(["content"],l)})(e,{breakpointName:i,attrState:a,pricingTablesId:n,flexColumnStructureValue:r,flexWrapValue:u,pricingTablesData:d})},rn=(e,t)=>{const n=e.getIn(["content"]),{id:r}=t,o=n.getIn([r]);if((0,g.isEmpty)(o))return e;const i=o.getIn(["parent"]),a=n.getIn([i,"children"],[]).asMutable().filter((e=>e!==r));let l=n.setIn([i,"children"],a);const s=(0,Q.populateContentTree)({tree:n,rootId:r});return(0,g.forEach)(s,((e,t)=>{l=l.without(t)})),e.setIn(["content"],l)},on=(e,t)=>{const n=e.getIn(["content",t]);return e.getIn(["content",(0,g.get)(n,"parent")])},an=R([G()(((e,t)=>{const n=[],r=t=>{const o=on(e,t);"divi/root"!==o?.name?o?.id&&(n.push({id:o.id,name:o.name}),r(o.id)):n.push({id:o.id,name:(0,mt.__)("Page","et_builder")})};return r(t),n})),(e,t,n)=>n||"top-to-bottom"],G()(((e,t)=>("top-to-bottom"===t&&e.reverse(),e)))),ln={},sn=R([e=>e.getIn(["content"]),(e,t="postContent")=>e.getIn(["layouts",t,"removedModules"])||ln],G()(((e,t)=>{if(!e)return{};const n={};for(const r in e){if(!Object.prototype.hasOwnProperty.call(e,r))continue;if(t[r])continue;const o=e[r],i=o.getIn(["props","attrs","module","advanced","loop"],null);if(!o.name||!i)continue;if(!("on"===i?.getIn(["desktop","value","enable"])))continue;const a=i?.getIn(["desktop","value","loopId"])??"";if(!a)continue;const l=o.getIn(["props","attrs","module","meta","adminLabel"],null)?.desktop?.value??"",s=o.name.replace("divi/","").replace(/-/g," "),u=l||`${s.charAt(0).toUpperCase()}${s.slice(1)}`;n[a]={label:u}}return n}))),un=R([e=>e],(e=>e.getIn(["content"]))),dn=(e,t)=>{const n=e.getIn(["content",t,"props","attrs","globalModule"],i()({})),r=e.getIn(["content",t,"props","attrs","globalParent"],i()({}));return"string"==typeof n?String(n):"string"==typeof r?String(r):null},cn=(e,t)=>{const n=e.getIn(["content"]),r=[];return Object.keys(n).forEach((n=>{const o=e.getIn(["content",n,"props","attrs"],i()({}))?.globalModule;o===t&&r.push(n)})),i()(r)},pn=R([e=>e,(e,t)=>t],((e,t)=>e.getIn(["content",t]))),mn=i()({}),gn=R([(e,t)=>e.getIn(["content",t,"props","attrs"],mn),(e,t,n)=>n,(e,t,n,r)=>r],((e,t,n)=>{const r=t.split(".");return e.getIn(r,n??mn)})),fn=R([e=>e,(e,t)=>t,(e,t,n)=>n],((e,t,n=i()({}))=>e.getIn(["content",t,"props","attrs"])||n)),In=R([(e,t)=>fn(e,t,i()({})),(e,t)=>pn(e,t)],((e,t)=>{if(!t||!e)return{};const n=t.getIn(["name"]);if(!n)return{};try{const t=(0,Q.getModuleMergedAttrs)({moduleName:n,moduleAttrs:{}}),r=e.asMutable({deep:!0}),o=(0,Q.flattenAttrs)(r),i=(0,Q.flattenAttrs)(t),a={};return Object.entries(o).forEach((([e,t])=>{const n=i[e],r=void 0===n||!(0,g.isEqual)(t,n),o=(0,Q.isMeaningfulValue)(t);r&&o&&(a[e]=t)})),a}catch(t){const n=e.asMutable({deep:!0}),r=(0,Q.flattenAttrs)(n),o=Object.entries(r).filter((([,e])=>(0,Q.isMeaningfulValue)(e)));return Object.fromEntries(o)}})),yn=R([(e,t)=>e.getIn(["content",t])],(e=>e?.getIn(["name"])??"")),En=R([(e,t)=>t,e=>e.getIn(["content"])],G()(((e,t)=>(0,g.pickBy)(t,(t=>(0,g.includes)(e,t.id)))))),_n=(e,t,n)=>B(t,e.getIn(["content"]),n),hn=(e,t)=>{const n=[t],r=e.getIn(["content"]),o=e=>{(0,g.forEach)((0,g.get)(e,"children",{}),(e=>{n.push(e),o(r.getIn([e]))}))};return o(r.getIn([t])),n},Mn=(e,t)=>{const n=e.getIn(["content",t,"name"]),r=e?.content[t]?.props?.attrs?.asMutable({deep:!0});return(0,Q.getModuleType)(n,r)},bn=(e,t)=>{const n=e.getIn(["content",t]),r=e.getIn(["content",t,"children"]);let o={[t]:n,root:{...e.getIn(["content","root"]),children:[t]}};const i=t=>{t?.forEach((t=>{o={...o,[t]:e.getIn(["content",t])};const n=e.getIn(["content",t,"children"]);n&&n.length>0&&i(n)}))};return i(r),o},vn=R([(e,t)=>e.getIn(["content",t])],(e=>e?.getIn(["parent"]))),On=(e,t)=>{const n=on(e,t),r=(0,g.get)(n,"name"),o=(0,g.get)(n,["props","attrs"],i()({})).asMutable({deep:!0});return(0,Q.getModuleType)(r,o)},An=R([e=>e.getIn(["content","root"])],(e=>e.getIn(["children"])?.asMutable()??[])),Tn=(e,t)=>{const n=e.getIn(["content",t]),r=e.getIn(["content",n?.parent,"children"])?.asMutable();return r||[]},Cn=e=>e.getIn(["specialtySection"]),Ln=e=>e.getIn(["presets"]),Dn=(e,t,n,r,o,i)=>{const a=t?(0,Q.getAttrSubnameValue)({attr:e,breakpoint:n,state:r,subname:t,baseBreakpoint:o,breakpointNames:i,mode:"get"}):(0,Q.getAttrValue)({attr:e,baseBreakpoint:o,breakpoint:n,breakpointNames:i,state:r,mode:"get"});return!(0,g.isNil)(a)},Sn=(e,t,n)=>{const r=fn(e,t,i()({}));return!!r&&(({attrName:e,subName:t,moduleAttrs:n,baseBreakpoint:r,breakpointNames:o,checkHover:i=!0,checkSticky:a=!0})=>{if(!(e&&n&&o&&r))return!1;const l=(0,g.get)(n,e);return!!l&&(!!o.filter((e=>e!==r)).some((e=>Dn(l,t,e,"value",r,o)))||!(!i||!Dn(l,t,r,"hover",r,o))||!(!a||!o.some((e=>Dn(l,t,e,"sticky",r,o)))))})({moduleAttrs:r,...n})},Rn=(e,t,n)=>{const r=(0,u.isStickyModule)(t,e?.content),o=(0,u.isInsideStickyModule)(t,e?.content);return n?o:r||o},Pn=(e,t)=>{const n=e=>{const t=(0,a.select)("divi/edit-post").getModule(e);if(!t)return!1;const r="on"===(0,g.get)(t.props.attrs,["module","decoration","disabledOn","desktopAbove","value"],"off"),o="on"===(0,g.get)(t.props.attrs,["module","decoration","disabledOn","tabletOnly","value"],"off"),i="on"===(0,g.get)(t.props.attrs,["module","decoration","disabledOn","phone","value"],"off"),l=r&&o&&i;return l||"divi/root"===t.name?l:n(t.parent)};return n(t)},Un=e=>{if(1<e.getIn(["content","root","children"]).length)return!1;const t=e.getIn(["content","root","children",0]);if(t){const n=e.getIn(["content",t,"props","attrs"]);if(!(0,g.isEmpty)(n))return!1}const n=[],r=t=>{t&&t.children&&t.children.forEach((t=>{if(t){const o=e.getIn(["content",t]);o&&(-1===n.indexOf(t)&&n.push(t),r(o))}}))};return r(e.getIn(["content","root"])),!(1<n.length)},Nn=R([(e,t)=>{let n={},r=0;const o=t=>{r++;const i=on(e,t);"divi/section"!==i?.name?"divi/root"!==i?.name&&(r>25||i?.id&&o(i.id)):n=i?.asMutable({deep:!0})},i=e.getIn(["content"]).getIn([t?.moduleId]);"divi/section"===i?.name?n=i?.asMutable({deep:!0}):o(t.moduleId);const a=n?.props?.attrs?.module?.advanced?.type?.desktop?.value;return["specialty","fullwidth"].includes(a)?a:"regular"},(e,t)=>t?.type],((e,t)=>e===t)),kn=R([e=>e,(e,t)=>t],((e,t)=>{if("sticky"!==t?.state)return!1;if(!1===t?.modal?.isActive)return!1;if(t?.id===t?.modal?.owner)return!0;const n=an(e,t?.modal?.owner);return!!Object.values(n).find((e=>e?.id===t?.id))&&(0,u.isStickyModule)(t?.id,e?.content?.asMutable({deep:!0}))})),wn=(e,t,n)=>{const r=e.getIn(["content",t]),{name:o}=r,i=(0,Q.getModuleType)(r?.name,r?.attrs).replace(/fullwidth-|specialty-|-inner/gi,""),a=(0,g.capitalize)(o.replace(/divi\//,""));return{...n,layout_name:n.layout_name.replace("%module%",a),layout_type:i,module_width:o.includes("divi/fullwidth")?"fullwidth":"regular"}},Gn=R([e=>e,(e,t)=>t],((e,t)=>{let n={};const r=e.getIn(["content",t,"children"])||[];return r.forEach((t=>{n={...n,[t]:e.getIn(["content",t])}})),n})),Vn=R([(e,t)=>hn(e,t),e=>e.getIn(["content"]),(e,t,n)=>n,(e,t,n,r)=>r,(e,t)=>t],((e,t,n,r,o)=>e.filter((e=>{if(e===o&&!r)return!1;const i=t.getIn([e])?.getIn(["name"],"");return i&&((e,t)=>{if(!e||!t)return!1;const n=t.split(",").map((e=>e.trim().toLowerCase().replace("divi/",""))),r=e.replace("divi/","").toLowerCase();return!!n.includes("all")||(n.includes("all-modules")?!Q.structuralModules.includes(e):n.includes("all-containers")?Q.structuralModules.includes(e):n.includes(r))})(i,n)})))),Fn=R([(e,t)=>e.getIn(["content",t],null),(e,t,n)=>n],((e,t)=>{if(!e)return null;const n=e.getIn(["props","attrs"],null);if(!n)return null;const r=n.getIn(["groupPreset"],null)?.getIn([t],null);let o=null;const a=n.modulePreset,l=e.name;if(l){const e=(0,Q.mergeNestedGroupPresets)(a,l,n);e[t]&&(o=e[t])}if(o&&r){const e=(0,Q.normalizePresetStack)(o.presetId),t=(0,Q.normalizePresetStack)(r.presetId).filter((t=>!e.includes(t)));if(0===t.length)return i()({presetId:e,groupName:r.groupName||o.groupName});const n=[...e,...t];return i()({presetId:n,groupName:r.groupName||o.groupName})}return r||(o?i()({presetId:o.presetId,groupName:o.groupName}):null)})),xn=i()({}),Bn=R([(e,t)=>e.getIn(["content",t,"props","attrs"],xn),(e,t)=>e.getIn(["content",t,"name"],""),(e,t,n)=>n],((e,t,n)=>{const r=e.modulePreset;if(!r||!t)return[];const o=(0,Q.mergeNestedGroupPresets)(r,t,e);if(!o[n])return[];const i=o[n];return i?.presetId?(0,Q.normalizePresetStack)(i.presetId):[]})),jn=i()({}),Yn=R([(e,t)=>e.getIn(["content",t,"props","attrs"],jn)],(e=>e.modulePreset)),$n=i()({}),Hn=R([(e,t)=>e.getIn(["content",t,"props","attrs"],$n),(e,t,n)=>n],((e,t)=>e.getIn(["groupPreset",t]))),zn=R([(e,t)=>yn(e,t.moduleId),(e,t)=>{const n=yn(e,t.moduleId);if(!t?.moduleId)return!1;if("divi/row"===n){const n=on(e,t.moduleId)?.name;return"divi/section"!==n}if("divi/column"===n){const n=on(e,t.moduleId),r=on(e,n?.id)?.name;return"divi/section"!==r}return an(e,t.moduleId)}],((e,t)=>(0,g.isBoolean)(t)?t:t.some((t=>t?.name===e)))),Wn=R([(e,{moduleId:t})=>an(e,t),(e,{types:t})=>t,e=>e],((e,t,n)=>e.filter((e=>"divi/column"===e.name)).some((e=>{const r=String(gn(n,e.id,"module.advanced.type.desktop.value","")),o=String(gn(n,e.id,"module.decoration.sizing.desktop.value.flexType","")),i=Array.isArray(t)?t:[t];return i.includes(r)||i.includes(o)})))),Kn=R([(e,t)=>e.getIn(["content",t,"props","attrs","css"])],(e=>{if(!e||!Object.keys(e).length)return{};const t=e.asMutable({deep:!0}),n={};return Object.entries(t).forEach((([e,t])=>{Object.entries(t).forEach((([t,r])=>{const o=r?.freeForm?.match(/\{([^{}]+)\}/);let i=o?o[1].trim():"";if(i=i.replace(/\n/g,"").replace(/ {2,}/g," "),i){n[e]||(n[e]={}),n[e]?.[t]||(n[e]={...n[e],[t]:{}});const r=(0,Q.parseCssVariables)(i);n[e][t]=r}}))})),n})),Xn={queryItems:[],isParentLoopEnabled:!1},qn=R([e=>e,(e,t)=>t],((e,t)=>{const n=e.getIn(["content",t,"props","attrs","module","advanced","loop"]),r="on"===(0,g.get)(n,"desktop.value.enable","off"),o=e.getIn(["loopData",t]);if(o&&r){return{...o.asMutable({deep:!0}),isParentLoopEnabled:!1}}const i=e.getIn(["content",t]);if(!i)return Xn;const a=t=>{const n=e.getIn(["content",t]);if(!n)return Xn;const r="on"===n.getIn(["props","attrs","module","advanced","loop"],null)?.desktop?.value?.enable,o=e.getIn(["loopData",t]);if(o){return{...o.asMutable({deep:!0}),isParentLoopEnabled:!0}}if(r)return{queryItems:[],isParentLoopEnabled:!0};if(n.parent){const e=a(n.parent);return{...e,isParentLoopEnabled:e.isParentLoopEnabled||r}}return Xn};return i.parent?a(i.parent):Xn})),Jn=R([(e,t)=>t,e=>e.content],((e,t)=>{if(!e)return null;return Object.keys(t.asMutable()).find((n=>{const r=t.getIn([n]);if(r){const t=r.getIn(["props","attrs"]);if(t){return t.getIn(["module","decoration","interactionTarget"])===e}}return!1}))||null})),Qn=R([(e,t)=>pn(e,t.moduleId),(e,t)=>t.moduleId,(e,t)=>t.attrName,e=>e],((e,t,n,r)=>{if(!e)return!1;const o=e.props?.attrs;if(!0===o?.localChildren)return!1;if(o?.globalModule){const e=o.localAttrsMap;if(e&&Array.isArray(e)&&n){if(e.some((e=>{const t=e.attrName;if(t===n)return!e.subName;if(n.startsWith(`${t}.`)){if(!e.subName)return!0;const r=n.substring(t.length+1);return r===e.subName||r.startsWith(`${e.subName}.`)}return!1})))return!1}return!0}if(o?.globalParent)return((e,t)=>{let n=0;const r=t=>{if(n>=20)return!0;n++;const o=pn(e,t);if(!o)return!0;const i=o.props?.attrs;if(i?.globalModule)return!0!==i.localChildren;const a=on(e,t);return!a?.id||"root"===a.id||r(a.id)};return r(t)})(r,t);const a=on(r,t);if(a?.id){const e=fn(r,a.id,i()({}));if(e?.globalModule){if(!0===e.localChildren)return!1}}return!0})),Zn=R([(e,t)=>e.getIn(["content",t,"props","attrs","globalModule"],""),(e,t)=>e.getIn(["content",t,"props","attrs","globalParent"],""),(e,t)=>an(e,t),e=>e],((e,t,n,r)=>{if(e)return!1;if(!t)return!1;if((0,g.isEmpty)(n))return!1;const o=n.reverse().find((e=>!!Boolean(r.getIn(["content",e.id,"props","attrs","globalModule"],""))));if((0,g.isEmpty)(o))return!1;return Boolean(r.getIn(["content",o.id,"props","attrs","localChildren"],!1))})),er=R([(e,t)=>e.getIn(["content",t]),(e,t)=>e.getIn(["content",t])?.getIn(["parent"]),(e,t)=>{const n=e.getIn(["content",t])?.getIn(["parent"]);if(!n)return null;return e.getIn(["content",n])?.getIn(["props","attrs"],null)||null},(e,t,n)=>n,(e,t,n,r)=>r,(e,t,n,r,o)=>o,(e,t,n,r,o,i)=>i],((e,t,n,r,o,i,l)=>{if(!t||!n)return{display:"flex",isFlexLayout:!0,isGridLayout:!1,isBlockLayout:!1};const s=n,u=(0,a.select)("divi/edit-post").getModule(t)?.getIn?.(["name"]),d=(0,Q.getParentLayoutAttrPath)(u,s),c=(0,g.get)(s,d),p=(0,a.select)("divi/app-ui"),m=(0,Q.getActiveModulePreset)({moduleName:u,moduleAttrs:s,selectFunction:a.select,useDefaultFallback:!0}),f=s.getIn(["groupPreset"],null)||{},I=Object.keys(f).find((e=>"divi/layout"===f[e]?.groupName))||"module.decoration.layout",y=(0,a.select)("divi/edit-post").getGroupPresetAttr(t,I),E=(0,a.select)("divi/global-data").getGroupPreset({groupName:"divi/layout",id:y?.presetId,useDefaultFallback:!0}),_=(0,g.get)(m?.attrs,"module.decoration.layout"),h=(0,g.get)(E?.attrs,"module.decoration.layout"),M=(0,g.merge)({},_,h,c),b=(0,Q.getAttrValue)({attr:M,breakpoint:r??p?.getBreakpoint()??"desktop",state:o??p?.getAttributeState()??"value",breakpointNames:i??Q.defaultBreakpointNames,baseBreakpoint:l??"desktop",mode:"getAndInheritAll"}),v=(0,Q.isGridModule)(u)?"grid":"flex",O=b?.display??v;return{display:O,isFlexLayout:"flex"===O,isGridLayout:"grid"===O,isBlockLayout:"block"===O}})),tr=(e,t,n,r)=>{if(!(0,v.applyFilters)("divi.editPost.moveModule.enable",!0,e,t,n,r))return e;const o=e,i=e.getIn(["content",t,"parent"]),l=e.getIn(["content",i,"children"]).filter((e=>e!==t)),s=(0,g.get)(e,["content",t,"name"],"");e=e.setIn(["content",i,"children"],l);const u="inside"===n?r:e.getIn(["content",r,"parent"]);if("divi/column"===s||"divi/column-inner"===s){const t=e.getIn(["content",u,"children"])?.length??0,n="block"!==e.getIn(["content",u,"props","attrs","module","decoration","layout","desktop","value","display"],"");if(t>={"divi/column":6,"divi/column-inner":3}[s]&&!n)return o}const d=(0,g.get)(e,["content",u,"name"],""),c=(0,g.get)(e,["content",u,"props","attrs"])||{};if(!(0,a.select)("divi/module-library").isValidChild(d,c,s))return o;if("divi/row"===s&&"divi/column"===d){if(!Nn(e,{moduleId:u,type:"regular"}))return o}const m=e.getIn(["content",u,"children"],[])?.asMutable(),f="inside"===n?m.concat([t]):p(t,r,m,n);return e.setIn(["content",t,"parent"],u).setIn(["content",u,"children"],f)},nr=(e,t)=>{switch(t.type){case"ADD_COLUMN_VIA_DIVIDER":return j(),((e,t,n,r)=>{let o=e.getIn(["content"]);const i=o.getIn([t],{}),a=i.getIn(["props","attrs","module","advanced","columnStructure","desktop","value"],"4_4").split(","),l=i.getIn(["children"],[]).asMutable(),s="divi/row-inner"===(0,g.get)(i,"name"),u=a.length+1,d=(0,g.times)(u,(()=>`1_${u}`)).join(","),c=s?"divi/column-inner":"divi/column",p=0===n?0:n-1,m=(0,g.nth)(l,p);o=Yt(o,m,c,{attrs:{builderVersion:r}},0===n?"before":"after");const f=e.setIn(["content"],o);return"grid"===f.getIn(["content",t,"props","attrs","module","decoration","layout","desktop","value","display"],"flex")?f:Ht(f,t,d,r)})(e,t.id,t.dividerPosition,t.builderVersion);case"ADD_FLEX_COLUMN_VIA_DIVIDER":return j(),((e,t,n,r,o)=>{const a=e.getIn(["content",t],null);if(!a)return e;const l=e.getIn(["content",n],null);if(!l)return e;let s=l?.getIn(["props","attrs","module","decoration","sizing","desktop","value","flexType"],"24_24");s&&"none"!==s||(s="24_24");const u=b(),d={attrs:{builderVersion:o,module:{decoration:{sizing:{desktop:{value:{flexType:s}}}}}}},c=a.getIn(["props","attrs","module","advanced","flexColumnStructure"],i()({desktop:{value:"equal-columns_1"}}));(0,g.forEach)(c,((n,r)=>{(0,g.forEach)(n,((n,o)=>{"desktop"===r&&"value"===o||(e=Qt(e,{rowId:t,breakpoint:r,state:o}))}))}));const p=(e=e.setIn(["content"],Yt(e.getIn(["content"]),n,"divi/column",d,r,u))).getIn(["content",t,"children"],[]).length,m=c.getIn(["desktop","value"]),f=(0,Q.getPremadeGrid)(m),I="wrap"===f?.layoutAttr?.desktop?.value?.flexWrap||"offset-columns"===f.category&&p<=f.template.length;return Jt(e,I?{id:t,value:m,breakpoint:"desktop",state:"value"}:{id:t,value:(0,Q.newFlexColumnStructure)(p),breakpoint:"desktop",state:"value"})})(e,t.rowId,t.columnId,t.position,t.builderVersion);case"ADD_GRID":return j(),e.set("content",en(e.getIn(["content"]),{id:t.id,position:t.position,template:t.template,isAddSection:t.isAddSection,builderVersion:t.builderVersion}));case"ADD_MODULE":return j(),e.set("content",Yt(e.getIn(["content"]),t.id,t.name,t.props,t.position,t.newId));case"ADD_ROW":return j(),e.set("content",tn(e.getIn(["content"]),t.id,t.position,t.columnStructure,t.builderVersion,t.inner));case"ADD_SPECIALTY_SECTION":return j(),e.set("content",((e,t,n,r,o)=>{if(!e.getIn([t]))return e;const a=(0,g.filter)(zt.columnSpecialty,(e=>e.structure===r));if((0,g.size)(a)<1)return e;const l=(0,g.filter)(a,(e=>e.position===o));if((0,g.size)(l)<1)return e;const s=e.getIn(["root","children"]),u=b(),d=i()({id:u,name:"divi/section",parent:"root",children:[],props:{attrs:{module:{advanced:{type:{desktop:{value:"specialty"}}}}}}}),c=p(u,t,s.asMutable(),n);e=e.merge({[u]:d}).setIn(["root","children"],c);const m=r.split(","),f=m.length,I={},y=o.split(",");for(let e=0;e<f;e++){const t=b();I[t]={id:t,name:"divi/column",parent:u,props:{attrs:{module:{advanced:{type:{desktop:{value:m[e]}}}}}},children:[]},"1"===y[e]&&(I[t].props.attrs.module.advanced.specialtyColumns={desktop:{value:"2_3"===m[e]?"4":"3"}})}return e.merge(i()(I)).setIn([u,"children"],(0,g.keys)(I))})(e.getIn(["content"]),t.id,t.position,t.columnStructure,t.innerPosition));case"CHANGE_COLUMN_STRUCTURE":return j(),Ht(e,t.id,t.columnStructure,t.builderVersion);case"CHANGE_FLEX_COLUMN_STRUCTURE":return j(),Jt(e,{id:t.id,value:t.value,breakpoint:t.breakpoint,state:t.state});case"CHANGE_GRID_COLUMN_STRUCTURE":return j(),((e,t)=>{const{id:n,value:r,breakpoint:o,state:a}=t,l=(0,Q.getPremadeGrid)(r);if(!l)return e;let s=e.getIn(["content"]);if("grid"===s.getIn([n,"props","attrs","module","decoration","layout","desktop","value","display"],null)?(s=Kt(s,n,`module.decoration.layout.${o}.${a}`),s=Wt(s,n,`module.decoration.layout.${o}.${a}.display`,"grid")):Q.allBreakpointNames.forEach((e=>{s=Kt(s,n,`module.decoration.layout.${e}`),s=Wt(s,n,`module.decoration.layout.${e}.value.display`,"grid")})),l.layoutAttr?.desktop?.value){const e=l.layoutAttr.desktop.value;Object.entries(e).forEach((([e,t])=>{if(null!=t){const r="string"==typeof t?t:i()(t);s=Wt(s,n,`module.decoration.layout.${o}.${a}.${e}`,r)}}))}else{const e=(l.template||[]).length;s=Wt(s,n,`module.decoration.layout.${o}.${a}.gridColumnWidths`,"equal"),s=Wt(s,n,`module.decoration.layout.${o}.${a}.gridColumnCount`,e.toString()),s=Wt(s,n,`module.decoration.layout.${o}.${a}.gridRowHeights`,"auto")}return s=Wt(s,n,`module.advanced.flexColumnStructure.${o}.${a}`,r),e.setIn(["content"],s)})(e,{id:t.id,value:t.value,breakpoint:t.breakpoint,state:t.state});case"CHANGE_PRICING_TABLES_FLEX_COLUMN_STRUCTURE":return j(),nn(e,{id:t.id,value:t.value,breakpoint:t.breakpoint,state:t.state});case"CHANGE_COLUMN_STRUCTURE_FOR_DRAG_AND_DROP":return j(),((e,t,n)=>{let r=e.getIn(["content"]);const o=r.getIn([t,"props","attrs","module","advanced","columnStructure","desktop","value"],""),i=r.getIn([n,"props","attrs","module","advanced","columnStructure","desktop","value"],""),a=o.split(",").length??0,l=i.split(",").length??0,s=e=>e>=2&&e<=6?Array(e).fill(`1_${e}`).join(","):"4_4",u=s(a-1),d=s(l+1);r=r.setIn([t,"props","attrs","module","advanced","columnStructure","desktop","value"],u).setIn([n,"props","attrs","module","advanced","columnStructure","desktop","value"],d);const c=r.getIn([n,"children"],[]),p=d.split(",")[0];c.forEach((e=>{r=r.setIn([e,"props","attrs","module","advanced","type","desktop","value"],p)}));const m=r.getIn([t,"children"],[]),g=u.split(",")[0];return m.forEach((e=>{r=r.setIn([e,"props","attrs","module","advanced","type","desktop","value"],g)})),e.setIn(["content"],r)})(e,t.sourceId,t.targetId);case"CHANGE_FLEX_COLUMN_STRUCTURE_FOR_DRAG_AND_DROP":return j(),((e,t)=>{const{id:n,parentRowId:r,targetRowColumnStructure:o}=t;let i=e.getIn(["content"]);const a=i.getIn([r]),l=i.getIn([r,"children"],[]);if(!a||!l)return e;if("block"===o){const t=l.length,o=`1_${t}`,a=Array(t).fill(o).join(","),s=[n,"props","attrs","module","advanced","type","desktop","value"];i=i.setIn(s,o);const u=[r,"props","attrs","module","advanced","columnStructure","desktop","value"];return i=i.setIn(u,a),l.forEach((e=>{if(e!==n){const t=[e,"props","attrs","module","advanced","type","desktop","value"];i=i.setIn(t,o)}})),e.setIn(["content"],i)}const s=l.indexOf(n);let u;u=0===s?l[s+1]:l[s-1];const d=i.getIn([u,"props","attrs","module","decoration","sizing","desktop","value","flexType"],"");return d&&(i=i.setIn([n,"props","attrs","module","decoration","sizing","desktop","value","flexType"],d)),e.setIn(["content"],i)})(e,{id:t.id,parentRowId:t.parentRowId,targetRowColumnStructure:t.targetRowColumnStructure});case"CLEAR_LAYOUT":return j(),e.set("content",(e=>{const t=b(),n={root:{id:"root",name:"divi/root",children:[t],props:{attrs:{}}},[t]:{id:t,name:"divi/section",children:[],parent:"root",props:{attrs:{builderVersion:e}}}};return i()(n)})(t.builderVersion));case"CLEAR_REMOVED_MODULES":return((e,t)=>{const n=t?.params?.layout??"postContent",r=e.getIn(["layouts",n,"removedModules"]);let o=e;return(0,g.forEach)(r,(r=>{const i=r?.id,a=(0,g.isObject)(e.getIn(["content",i])),l=e.getIn(["content",i,"parent"]),s=e.getIn(["content",l,"children"],[]),u=(0,g.includes)(s,i);a&&!u&&(o=rn(o,{id:i,caller:t?.params?.caller})),o=o.setIn(["layouts",n,"removedModules"],e.getIn(["layouts",n,"removedModules"]).without(i))})),o})(e,t);case"CLONE_MODULE":return j(),e.set("content",((e,t)=>{const{id:n,moduleAppearanceSettings:r,themeBuilderLayout:o,moduleCount:i}=t,{clonedParent:a,clonedParentChildren:l,clonedModules:s}=N(e,{moduleId:n,targetParentId:"",moduleAppearanceSettings:r,themeBuilderLayout:o,moduleCount:i});return e.getIn(["content"]).merge(s).setIn([a,"children"],l)})(e,t.params));case"CLONE_COLUMN":return j(),((e,t)=>{const n=e.getIn(["content"]),{id:r,moduleAppearanceSettings:o={},themeBuilderLayout:i="postContent",moduleCount:a}=t,l=n.getIn([r],{}).getIn(["name"],"");if("divi/column"!==l&&"divi/column-inner"!==l)return e;const{clonedParent:s,clonedParentChildren:u,clonedModules:d}=N(e,{moduleId:r,moduleAppearanceSettings:o,themeBuilderLayout:i,moduleCount:a}),c=n.getIn([s],{}),p=c.getIn(["props","attrs","module","decoration","layout","desktop","value","display"],"flex"),m="grid"===p||"flex"===p,f=n.merge(d).setIn([s,"children"],u),I=e.setIn(["content"],f);if(m)return I;const y=c.getIn(["props","attrs","module","advanced","columnStructure","desktop","value"],"4_4").split(",").length+1,E=(0,g.times)(y,(()=>`1_${y}`)).join(",");return Ht(I,s,E)})(e,t.params);case"CLONE_FLEX_COLUMN":return j(),((e,t)=>{const n=e.getIn(["content"]),{id:r,moduleAppearanceSettings:o={},themeBuilderLayout:i="postContent",moduleCount:a}=t,l=n.getIn([r],{}).getIn(["name"],"");if("divi/column"!==l&&"divi/column-inner"!==l)return e;const{clonedParent:s,clonedParentChildren:u,clonedModules:d}=N(e,{moduleId:r,moduleAppearanceSettings:o,themeBuilderLayout:i,moduleCount:a}),c=n.merge(d).setIn([s,"children"],u);return e.setIn(["content"],c)})(e,t.params);case"CONVERT_SELECTED_MODULES_TO_GROUP":return j(),e.set("content",((e,t)=>{const n=t[0],r=e.getIn([n,"parent"],""),o=b(),i=e.getIn([r,"props","attrs","globalModule"],!1),a=e.getIn([r,"props","attrs","globalParent"],!1),l=i||a||!1,s={id:o,children:[...t],name:"divi/group",parent:r,props:{}},u=e.getIn([r,"children"],[]),d=p(s.id,n,u.asMutable(),"after");return e=e.merge({[s.id]:s}).setIn([r,"children"],d),l?e.setIn([s.id,"props","attrs","globalParent"],l):(t.forEach((t=>{const n=e.getIn([t,"parent"]),r=e.getIn([n,"children"],[]);e=(e=e.setIn([n,"children"],r.asMutable().filter((e=>e!==t)))).setIn([t,"parent"],s.id)})),e)})(e.getIn(["content"]),t.selectedModuleIds));case"COPY_MODULE":return j(),e.set("content",((e,t)=>{const n=e.getIn(["content"]),{id:r,position:o,targetId:i,moduleAppearanceSettings:a,themeBuilderLayout:l,moduleCount:s}=t,u="inside"===o?i:n.getIn([i,"parent"]),d=n.getIn([i,"props","attrs","globalParent"]),{clonedModuleId:m,clonedModules:g}=N(e,{moduleId:r,targetParentId:u,moduleAppearanceSettings:a,themeBuilderLayout:l,moduleCount:s}),f=n.getIn([u,"children"],[]),I="inside"===o?f.concat([m]):p(m,i,f.asMutable(),o);if(d){let e=n.merge(g).setIn([u,"children"],I).setIn([m,"props","attrs","globalParent"],d);return e=c(e,m,d),e}return n.merge(g).setIn([u,"children"],I)})(e,t.params));case"COPY_MODULE_FROM_LIBRARY":return j(),e.set("content",((e,t,n,r,o)=>{const a="inside"===n?r:e.getIn([r,"parent"]),l=e.getIn([a]).asMutable({deep:!0}),s=(0,Q.maybeUnwrapPlaceholderBlock)(t.getIn(["content"],"")),u=k(o||s);let d=i()(H(u,{...l,children:[]}));if("inside"===n){const t=e.getIn([a,"children"],[]),n=d.getIn([a,"children"],[]),r=[...t.asMutable(),...n.asMutable()];d=d.setIn([a,"children"],r)}if("inside"!==n){const t=e.getIn([a,"children"],[]),o=d.getIn([a,"children"]),i=t.reduce(((e,t)=>t===r?"before"===n?e.concat([...o.asMutable(),t]):e.concat([t,...o.asMutable()]):e.concat(t)),[]);d=d.setIn([a,"children"],i)}if("global"===t.is_global){const e=d.getIn([a,"children"],[]);Object.keys(d.without(a)).forEach((n=>{d=e.includes(n)?d.setIn([n,"props","attrs","globalModule"],String(t.ID)):d.setIn([n,"props","attrs","globalParent"],String(t.ID))}))}return e.merge(d)})(e.getIn(["content"]),t.payload,t.position,t.targetId));case"COPY_MODULE_FROM_PAYLOAD":return j(),e.set("content",((e,t)=>{const n=e.getIn(["content"]),{payload:r,position:o,targetId:i,moduleAppearanceSettings:a,themeBuilderLayout:l,moduleCount:s}=t,u=r.moduleObjects.getIn([r.moduleId,"parent"]),d=n.getIn([u]),m="inside"===o?i:n.getIn([i,"parent"]),g=n.getIn([m]),f=n.getIn([i,"props","attrs","globalParent"]),I=r.moduleObjects.setIn([u],d).setIn([m],g),y=e.setIn(["content"],I),{clonedModuleId:E,clonedModules:_}=N(y,{moduleId:r.moduleId,targetParentId:m,moduleAppearanceSettings:a,themeBuilderLayout:l,moduleCount:s}),h=n.getIn([m,"children"],[]),M="inside"===o?h.concat([E]):p(E,i,h.asMutable(),o);if(f){let e=n.merge(_).setIn([m,"children"],M).setIn([E,"props","attrs","globalParent"],f);return e=c(e,E,f),e}return n.merge(_).setIn([m,"children"],M)})(e,t.params));case"COPY_MODULES_FROM_PAYLOAD":return j(),e.set("content",((e,t)=>{const{payload:n,position:r,targetId:o,moduleAppearanceSettings:a,themeBuilderLayout:l,moduleCount:s}=t;let u=o,d=r,m=e.getIn(["content"]);return(0,g.forEach)(n.moduleIds,(t=>{const r=n.moduleObjects.getIn([t,"parent"]),g=m.getIn([r]),f="inside"===d?u:m.getIn([u,"parent"]),I=m.getIn([f]),y=m.getIn([o,"props","attrs","globalParent"]),E=n.moduleObjects.setIn([r],g).setIn([f],I),_=e.setIn(["content"],E),{clonedModuleId:h,clonedModules:M}=N(_,{moduleId:t,targetParentId:f,moduleAppearanceSettings:a,themeBuilderLayout:l,moduleCount:s}),b=m.getIn([f,"children"],i()([])),v="inside"===d?b.concat([h]):p(h,u,b.asMutable(),d);u=h,d="after",y&&(m=m.merge(M).setIn([f,"children"],v).setIn([h,"props","attrs","globalParent"],y),m=c(m,h,y)),m=m.merge(M).setIn([f,"children"],v)})),m})(e,t.params));case"DISABLE_GLOBAL_MODULE":return j(),e.set("content",((e,t)=>{let n=e;const r=t=>{const o=e.getIn([t,"props","attrs"]).without("globalModule").without("globalParent");n=n.setIn([t,"props","attrs"],o);const i=e.getIn([t,"children"]);(0,g.isEmpty)(i)||(0,g.forEach)(i,(e=>{r(e)}))};return r(t),n})(e.getIn(["content"]),t.id));case"EDIT_CHILDREN":return j(),e.set("content",((e,t,n)=>e.setIn([t,"children"],n))(e.getIn(["content"]),t.id,t.children));case"IMPORT_CONTENT":return j(),e.set("content",(({state:e,content:t,presetIdsToReplace:n,defaultPresetAttrs:r,importOptionsValues:l,defaultImportedModulePresetIds:s,defaultImportedGroupPresetIds:u})=>{const d=(0,a.select)("divi/settings").getSetting(["conditionalTags","is_tb"]),{replaceLayout:c,removeGlobalScope:p}=l;let m=t;m=m.replace(/<!-- wp:divi\/placeholder -->\s*<!-- wp:divi\/placeholder -->/g,"\x3c!-- wp:divi/placeholder --\x3e"),m=m.replace(/<!-- \/wp:divi\/placeholder -->\s*<!-- \/wp:divi\/placeholder -->/g,"\x3c!-- /wp:divi/placeholder --\x3e"),"off"!==p&&(m=m.replace(/,?"globalModule":"\d+",?/g,"").replace(/,?"globalParent":"\d+",?/g,"")),d||(m=m.replace(/<!-- wp:divi\/post-content.*?-->/g,""));const f=H(m);"off"!==p&&(0,g.forEach)(f,((e,t)=>{if("divi/global-layout"===e.name){const n=e.props?.attrs||{};n.blockName&&n.localAttrs&&(f[t].name=n.blockName,f[t].props.attrs=n.localAttrs)}else e.props?.attrs?.globalModule&&(delete f[t].props.attrs.globalModule,delete f[t].props.attrs.localAttrsMap);e.props?.attrs?.globalParent&&delete f[t].props.attrs.globalParent}));const I=(0,g.filter)(f,(e=>"divi/section"===e.name||"divi/shortcode-module"===e.name&&"et_pb_section"===(0,g.get)(e,"props.attrs.shortcodeName")||"divi/global-layout"===e.name&&"off"===p));let y=i()(f);(0,g.forEach)(n,((e,t)=>{Object.values(f).filter((({name:e})=>e===t)).map((({id:e})=>e)).forEach((t=>{const n=y.getIn([t,"props","attrs"],null)?.modulePreset;if(n&&Array.isArray(n)&&n.length>0){const r=n.map((t=>e[t]||t));y=y.setIn([t,"props","attrs","modulePreset"],r)}}))})),(0,g.forEach)(r,((e,t)=>{Object.values(f).filter((({name:e})=>e===t)).map((({id:e})=>e)).forEach((t=>{const n=y.getIn([t,"props","attrs"],null)?.modulePreset,r=(0,Q.normalizePresetStack)(n);"default"===(r.length>0?r[r.length-1]:null)&&(y=y.setIn([t,"props","attrs"],(0,g.merge)({},e,y.getIn([t,"props","attrs"]).asMutable({deep:!0}))))}))})),(0,g.isEmpty)(s)||(0,g.forEach)(s,(({moduleName:e,presetId:t})=>{(0,g.forEach)(f,(({props:n,name:r,id:o})=>{e===r&&"divi/root"!==r&&((0,g.get)(n,["attrs","modulePreset"])||(y=y.setIn([o,"props","attrs","modulePreset"],t)))}))})),(0,g.forEach)(f,(({name:e,id:t})=>{if("divi/root"===e)return;const n=y.getIn([t,"props","attrs"],null),r=n?.modulePreset;if(!r)return;const i=(0,Q.getPresetsAttrsByModule)({moduleName:e,moduleAttrs:(0,o.asMutable)(n,{deep:!0}),presetType:"module",attrsKeys:["attrs","styleAttrs"],selectFunction:a.select});if(!i||(0,g.isEmpty)(i.attrs)&&(0,g.isEmpty)(i.styleAttrs))return;const l=(0,g.merge)({},i.attrs?.asMutable({deep:!0})||{},i.styleAttrs?.asMutable({deep:!0})||{});if((0,g.isEmpty)(l))return;const s=(0,o.asMutable)(n,{deep:!0}),u=(0,Q.removeMatchingValues)(s,l);(0,g.isEqual)(s,u)||(y=y.setIn([t,"props","attrs"],u))})),(0,g.isEmpty)(u)||(0,g.forEach)(f,(({props:e,name:t,id:n})=>{if("divi/root"===t)return;const r=(0,a.select)("divi/module-library").getModule(t),i=(0,g.isUndefined)(r)?{}:(0,Q.getGroupPresetDefaultAttr)((0,o.asMutable)(r,{deep:!0})),l=(0,g.get)(e,["attrs","groupPreset"],{}),s=(0,g.merge)({},i,l);if(!s)return;const d=y.getIn([n,"props","attrs","groupPreset"])?.asMutable({deep:!0});let c=d??{};(0,g.forEach)(u,(e=>{const t=Object.fromEntries(Object.entries(s).filter((([t,n])=>n.groupName===e.groupName))),n=Object.keys(s).find((t=>s[t].groupName===e.groupName)),r=!(!n||!s[n]),o=s[n]?.presetId,i=e.groupName,a=e.presetId;(0,g.forEach)(t,((t,n)=>{t.groupName===e.groupName&&(0,g.isEmpty)(t.presetId)&&(c={...c,[n]:{presetId:a,groupName:i}})})),(0,g.isEmpty)(d)&&r?c={...c,[e.groupId]:{presetId:a,groupName:i}}:!(0,g.isEmpty)(d)&&r&&(0,g.isEmpty)(o)&&(c={...c,[e.groupId]:{...c[e.groupId],presetId:a,groupName:i}})})),(0,g.isEmpty)(c)||(y=y.setIn([n,"props","attrs","groupPreset"],c))}));const E=(0,g.values)((0,g.map)(I,"id"));if("on"===c)return y.setIn(["root","children"],E);const _=[...e.getIn(["root","children"]).asMutable(),...E];return e.merge(y).setIn(["root","children"],(0,g.values)(_))})({state:e.getIn(["content"]),content:t.content,presetIdsToReplace:t.presetIdsToReplace,defaultPresetAttrs:t.defaultPresetAttrs,importOptionsValues:t.importOptionsValues,defaultImportedModulePresetIds:t.defaultImportedModulePresetIds,defaultImportedGroupPresetIds:t.defaultImportedGroupPresetIds}));case"MERGE_GLOBAL_MODULES":return j(),e.set("content",((e,t,n)=>{const{root:r,...o}=t,a=e.getIn([n,"parent"]),l=e.getIn([n,"props","attrs","localChildren"]),s=!0===l,u=t?.root?.children[0],d=e.getIn([a,"children"],[]).reduce(((e,t)=>t===n?e.concat(r.children):e.concat(t)),[]),c=o[t.root.children[0]].props.attrs,p=e.getIn([n,"props","attrs"],i()({})).getIn(["localAttrs"])?.asMutable({deep:!0}),m={globalModule:e.getIn([n,"props","attrs","globalModule"])},f=c.localAttrsMap||[],I={...c};p&&Object.keys(p).length>0&&f.length>0&&f.forEach((e=>{const{attrName:t}=e;if(!t)return;const n=t.split(".");if(e.subName){const t=e.subName.split("."),r=(0,g.get)(p,n);r&&(0,g.forEach)(r,((e,r)=>{e&&"object"==typeof e&&(0,g.forEach)(e,((e,o)=>{if(e&&"object"==typeof e){const i=(0,g.get)(e,t);if(void 0!==i){const e=[...n,r,o,...t];(0,g.set)(I,e,i)}}}))}))}else{const e=(0,g.get)(p,n);void 0!==e&&(0,g.set)(I,n,e)}}));const y={...I,...l?{localChildren:l}:{},...m,...f.length>0&&{localAttrsMap:f}};let E;if(s){const t=e.getIn([n,"children"],[]).filter((e=>e)),r=o[u],i={...r,id:u,parent:a,children:t,props:{...r.props,attrs:y}};let l=e;t.forEach((e=>{l=l.setIn([e,"parent"],u)})),E=l.setIn([a,"children"],d).without(n).setIn([u],i)}else E=e.merge(o).setIn([a,"children"],d).without(n).setIn([t?.root?.children[0],"parent"],a).setIn([t?.root?.children[0],"props","attrs"],y);return E})(e.getIn(["content"]),t.content,t.owner));case"MOVE_MODULE":return j(),tr(e,t.id,t.position,t.targetId);case"MOVE_MODULES":return j(),((e,t,n,r,o)=>{const a=B(t,e.getIn(["content"]),!0),l=(0,g.map)((0,g.values)(a),(e=>(0,Q.getModuleType)(e.name,e.props.attrs))),s=(0,g.uniq)(l);if(s.length>1){const l=(0,Q.extractLowestModuleType)(s),u=(0,Q.getParentType)(l),d=u&&(0,g.isString)(u)?(0,Q.getChildType)(u):"",c=(0,g.mapValues)(Q.moduleTypeRanks,(()=>null)),p=(0,g.sortBy)((0,g.values)(a),(e=>Q.moduleTypeRanks[(0,Q.getModuleType)(e.name,e.props.attrs)]+t.indexOf(e.id)/100)),m=t=>{(0,g.forEach)(t,(t=>{const n=(0,Q.getModuleType)(t.name,t.props.attrs);if((0,g.isNull)(c[n])){c[n]=t;const r=B(t.children,e.getIn(["content"]),!0);m((0,g.values)(r))}}))};m(p);let f=!(0,g.isNull)(c.section);const I=!(0,g.isNull)(c["specialty-section"]),y=!(0,g.isNull)(c["fullwidth-section"]),E=!(0,g.isNull)(c["fullwidth-module"]),_=!(0,g.isNull)(c.row),h=!(0,g.isNull)(c.column),M=!(0,g.isNull)(c.module);if(!f&&M&&y&&!I){const t=b(),n={attrs:{}};e=e.setIn(["content"],Yt(e.getIn(["content"]),r,"divi/section",n,"after",t)),c.section=e?.content?.[t]?.asMutable({deep:!0}),f=!0}if(f&&M){const t=!(0,g.isNull)(c.row),n=!(0,g.isNull)(c.column);if(!t){const t=b(),n=(e=e.setIn(["content"],tn(e.getIn(["content"]),c.section.id,"inside","4_4",o,!1,t))).getIn(["content",t,"children",0]);c.row=e?.content?.[t]?.asMutable({deep:!0}),c.column=e?.content?.[n]?.asMutable({deep:!0})}if(t&&!n){const t=(0,g.get)(c,["row","id"]),n=b(),r={attrs:{module:{advanced:{type:{desktop:{value:"4_4"}}}}}};e=(e=e.setIn(["content"],Wt(e.getIn(["content"]),t,"module.advanced.columnStructure",i()({desktop:{value:"4_4"}})))).setIn(["content"],Yt(e.getIn(["content"]),t,"divi/column",r,"inside",n)),c.column=e?.content?.[n]?.asMutable({deep:!0})}}if(!y&&E&&(f||I)){const t=b(),n={attrs:{module:{advanced:{type:{desktop:{value:"fullwidth"}}}}}};e=e.setIn(["content"],Yt(e.getIn(["content"]),r,"divi/section",n,"after",t)),c["fullwidth-section"]=e?.content?.[t]?.asMutable({deep:!0})}if(!f&&_&&!h){const t=b();e=(e=e.setIn(["content"],Wt(e.getIn(["content"]),c.row.id,"module.advanced.columnStructure",i()({desktop:{value:"4_4"}})))).setIn(["content"],Yt(e.getIn(["content"]),c.row.id,"divi/column",{attrs:{module:{advanced:{type:{desktop:{value:"4_4"}}}}}},"inside",t)),c.column=e?.content?.[t]?.asMutable({deep:!0})}let v=null;(0,g.forEach)(p,(t=>{const o=(0,Q.getModuleType)(t.name,t.props.attrs),i=(0,Q.getParentType)(o);if((0,g.isArray)(d)?(0,g.includes)(d,o):d===o)e=(0,g.isNull)(v)?tr(e,t.id,n,r):tr(e,t.id,"after",v),v=t.id;else if((0,g.isString)(i)&&!(0,g.isEmpty)((0,g.get)(c,[i,"children"]))){const n=(0,g.get)(c,[o,"id"]);e=tr(e,t.id,"inside",(0,g.get)(e,["content",n,"parent"]))}else(0,g.isArray)(i)?(0,g.forEach)(i,(n=>{(0,g.isNull)(c[n])||(e=tr(e,t.id,"inside",(0,g.get)(c,[n,"id"])))})):i&&(0,g.isString)(i)&&!(0,g.isNull)(c[i])&&(e=tr(e,t.id,"inside",(0,g.get)(c,[i,"id"])))}))}else{let o=r;(0,g.forEach)(t,(t=>{e=tr(e,t,n,o),"after"===n&&(o=t)}))}return e})(e,t.ids,t.position,t.targetId,t.builderVersion);case"EDIT_LOCAL_CHILDREN":return j(),e.set("content",((e,t,n)=>{if(!e.getIn([t,"props","attrs","globalModule"]))return e;const r=!n;return e.setIn([t,"props","attrs","localChildren"],r)})(e.getIn(["content"]),t.params.id,t.params.isSynced));case"EDIT_MODULE_ATTRIBUTE":return j(),e.set("content",Wt(e.getIn(["content"]),t.id,t.attrName,t.value,t.caller));case"ADD_MODULE_PRESET_TO_STACK":return j(),e.set("content",((e,t,n)=>{const r=e.getIn([t,"props","attrs","modulePreset"]),o=(0,Q.addPresetToStack)(r,n);return(0,Q.isStackUnchanged)({currentValue:r,updatedStack:o})?e:(0,Q.updateModulePresetInState)({state:e,moduleId:t,updatedStack:o})})(e.getIn(["content"]),t.id,t.presetId));case"REMOVE_MODULE_PRESET_FROM_STACK":return j(),e.set("content",((e,t,n)=>{const r=e.getIn([t,"props","attrs","modulePreset"]),o=(0,Q.removePresetFromStack)(r,n);return(0,Q.updateModulePresetInState)({state:e,moduleId:t,updatedStack:o})})(e.getIn(["content"]),t.id,t.presetId));case"REPLACE_MODULE_PRESET_IN_STACK":return j(),e.set("content",((e,t,n,r)=>{const o=e.getIn([t,"props","attrs","modulePreset"]),i=(0,Q.replacePresetInStack)(o,n,r);return(0,Q.isStackUnchanged)({currentValue:o,updatedStack:i,deepCompare:!0})?e:(0,Q.updateModulePresetInState)({state:e,moduleId:t,updatedStack:i})})(e.getIn(["content"]),t.id,t.oldPresetId,t.newPresetId));case"ADD_GROUP_PRESET_TO_STACK":return j(),e.set("content",((e,t,n,r,o)=>{const i=e.getIn([t,"props","attrs"],null)?.getIn(["groupPreset"],null),a=i?.getIn([n],null)?.presetId,l=(0,Q.addPresetToStack)(a,o);return(0,Q.isStackUnchanged)({currentValue:a,updatedStack:l})?e:(0,Q.updateGroupPresetInState)({state:e,moduleId:t,groupId:n,groupName:r,updatedStack:l})})(e.getIn(["content"]),t.id,t.groupId,t.groupName,t.presetId));case"REMOVE_GROUP_PRESET_FROM_STACK":return j(),e.set("content",((e,t,n,r)=>{const o=e.getIn([t,"props","attrs"],null)?.getIn(["groupPreset"],null),i=o?.getIn([n],null)?.presetId,a=(0,Q.removePresetFromStack)(i,r),l=(0,Q.getGroupNameFromState)({state:e,moduleId:t,groupId:n});return(0,Q.updateGroupPresetInState)({state:e,moduleId:t,groupId:n,groupName:l,updatedStack:a})})(e.getIn(["content"]),t.id,t.groupId,t.presetId));case"REPLACE_GROUP_PRESET_IN_STACK":return j(),e.set("content",((e,t,n,r,o)=>{const i=e.getIn([t,"props","attrs"],null)?.getIn(["groupPreset"],null),a=i?.getIn([n],null)?.presetId,l=(0,Q.replacePresetInStack)(a,r,o);if((0,Q.isStackUnchanged)({currentValue:a,updatedStack:l,deepCompare:!0}))return e;const s=(0,Q.getGroupNameFromState)({state:e,moduleId:t,groupId:n});return(0,Q.updateGroupPresetInState)({state:e,moduleId:t,groupId:n,groupName:s,updatedStack:l})})(e.getIn(["content"]),t.id,t.groupId,t.oldPresetId,t.newPresetId));case"EDIT_LOCAL_ATTRS_MAP":return j(),e.set("content",((e,t,n,r)=>{const o=e.getIn([t,"props","attrs","localAttrsMap"])||[];return r?e.setIn([t,"props","attrs","localAttrsMap"],[...o,n]):(0,g.isEmpty)(o)?e:e.setIn([t,"props","attrs","localAttrsMap"],o.filter((e=>!(e?.attrName===n?.attrName&&e?.subName===n?.subName))))})(e.getIn(["content"]),t.id,t.attribute,t.isSynced));case"EDIT_MODULE_PROP":return j(),e.set("content",((e,t,n,r)=>e.setIn([t,"props",n],r))(e.getIn(["content"]),t.id,t.propName,t.propValue));case"REMOVE_GROUP_PRESET_ATTRIBUTE":return j(),e.set("content",((e,t,n,r)=>{const o=e.getIn([t,"props","attrs"]);if(!(0,g.isEmpty)(o[n])){const i=o.getIn([n]).without(r),a=o.set(n,i);return e.setIn([t,"props","attrs"],a)}return e})(e.getIn(["content"]),t.id,t.attrName,t.groupId));case"REPLACE_MODULE_ATTRIBUTES":return j(),e.set("content",((e,t,n,r=!1)=>r?e.setIn([t,"props","attrs"],n):((0,g.forEach)(n,((n,r)=>{e=e.setIn([t,"props","attrs",r],n)})),e))(e.getIn(["content"]),t.id,t.attrs,t.replaceAllAttrs));case"REMOVE_GLOBAL_MODULE_ATTRIBUTE":return j(),e.set("content",((e,t)=>{const n=e.getIn([t,"props","attrs"]);return e.setIn([t,"props","attrs"],n.without("globalModule"))})(e.getIn(["content"]),t.id));case"REMOVE_GLOBAL_PARENT_ATTRIBUTE":return j(),e.set("content",((e,t)=>{const n=e.getIn([t,"props","attrs"]);return n?e.setIn([t,"props","attrs"],n.without("globalParent")):e})(e.getIn(["content"]),t.id));case"RESET_FLEX_COLUMN_STRUCTURE":return j(),Qt(e,t);case"REMOVE_MODULE":return j(),$t(e,t.id,t.builderVersion);case"REMOVE_MODULE_STATE_PROPERTIES":return rn(e,t.params);case"REMOVE_MODULE_ATTRIBUTE":return j(),e.set("content",Kt(e.getIn(["content"]),t.id,t.attrName));case"REMOVE_MODULE_ATTRIBUTES":return j(),e.set("content",(n=e.getIn(["content"]),r=t.id,t.attrNames.forEach((e=>{n=Kt(n,r,e)})),n));case"REMOVE_COLUMN":return j(),((e,t,n="postContent")=>{let r=e.getIn(["content"]);const o=r.getIn([t],{}),i=o.getIn(["name"],""),a="divi/column"===i||"divi/column-inner"===i;if((0,g.isEmpty)(o)||!a)return e;const l=o.getIn(["parent"]),s=r.getIn([l,"children"],[]).asMutable(),u=s.indexOf(t);if(u<0)return e;const d=[...s];d.splice(u,1),r=r.setIn([l,"children"],d);const c=e.setIn(["content"],r).setIn(["layouts",n,"removedModules",t],{id:t,timestamp:Date.now()});if("flex"===r.getIn([l],{}).getIn(["props","attrs","module","decoration","layout","desktop","value","display"],"block"))return c;const p=s.length-1,m=(0,g.times)(p,(()=>1===p?"4_4":`1_${p}`)).join(",");return Ht(c,l,m)})(e,t.id);case"SET_GLOBAL_MODULE_ATTRIBUTE":return j(),e.set("content",((e,t,n)=>e.setIn([t,"props","attrs","globalModule"],n))(e.getIn(["content"]),t.id,t.value));case"SET_GLOBAL_PARENT_ATTRIBUTE":return j(),e.set("content",((e,t,n)=>{let r=e.setIn([t,"props","attrs","globalParent"],n);return r=c(r,t,n),r})(e.getIn(["content"]),t.id,t.value));case"SET_LAYOUT_STATE":return j(),e.set(t.location,t.layoutState);case"SET_SPECIALITY_SECTION_STATUS":return j(),e.set("specialtySection",t.status);case"SYNC_GLOBAL_LAYOUT_ATTRIBUTES":return j(),e.set("content",((e,t,n,r)=>{if(!Array.isArray(r))return e;const o=e.asMutable({deep:!0}),a=n.asMutable?n.asMutable({deep:!0}):n,l=(0,g.get)(o,[t,"props","attrs","localChildren"]),s=(0,g.get)(a,["localChildren"]);let u;return!0!==l&&!0!==s||(u=e.getIn([t,"children"])),e=(e=e.setIn([t,"props","attrs"],i()(a))).setIn([t,"props","attrs","localAttrsMap"],r),r.forEach((n=>{const{attrName:r,subName:i}=n,a=r.split(".");if(i){const n=i.split("."),r=(0,g.get)(o,[t,"props","attrs",...a]),l=(0,g.get)(e.asMutable({deep:!0}),[t,"props","attrs",...a]);r&&l&&"object"==typeof r&&"object"==typeof l&&Object.keys(l).forEach((o=>{if("object"==typeof l[o]&&"value"in l[o]){const i=(0,g.get)(r,[o,"value",...n]);void 0!==i&&(e=e.setIn([t,"props","attrs",...a,o,"value",...n],i))}}))}else{const n=(0,g.get)(o,[t,"props","attrs",...a]);e=e.setIn([t,"props","attrs",...a],n)}})),!0!==l&&!0!==s||!u||(e=e.setIn([t,"children"],u)),e})(e.getIn(["content"]),t.id,t.attrs,t.localAttrsMap));case"SYNC_MODULE_INLINE_FONT":return e.set("content",(e=>{const t={...e},n=(0,g.filter)(t,(e=>{const t=e.getIn(["props","attrs","content","decoration","inlineFont"],[]);return!(0,g.isEmpty)(t)}));return 0===n.length||(0,g.forEach)(n,(t=>{const n=t.getIn(["props","attrs","content","innerContent"],{});(0,g.forEach)(n,((n,r)=>{(0,g.forEach)(n,((n,o)=>{const i=z(n),a=[t.id,"props","attrs","content","decoration","inlineFont",r,o,"families"];e=e.setIn(a,i)}))}))})),e})(e.getIn(["content"])));case"SYNC_MODULE_GLOBAL_COLORS":return e.set("content",((e,t)=>{let n=JSON.stringify({...e});const r=new RegExp(/var[(]--(gcid-([0-9a-z-]*))[)]/,"g"),o=Array.from(n.matchAll(r));if(o.length>0){const e={},r=o.map((e=>e[1]));(0,g.forEach)(t,((t,n)=>{r.includes(n)&&(e[n]=t)})),(0,g.isEmpty)(e)||(0,g.forEach)(e,((e,t)=>{"inactive"===e.status&&(n=n.replace(new RegExp(`var[(]--${t}[)]`,"g"),e.color))}))}try{let t=i()(e);const r=JSON.parse(n);return Object.keys(r).forEach((e=>{t=t.setIn([e],r[e])})),t}catch(e){console.error(e)}return e})(e.getIn(["content"]),t.globalColors));case"UPDATE_USED_PRESETS":return e.set("presets",((e,t)=>e.setIn([t.presetType],t.presets))(e.getIn(["presets"]),{presetType:t.presetType,presets:t.presets}));case"REVERT_GLOBAL_MODULE_EDIT_STATE":return j(),e;case"EDIT_GROUP_PRESET_ATTR":return j(),e.set("content",((e,t,n,r)=>e.setIn([t,"props","attrs","groupPreset",n],r))(e.getIn(["content"]),t.id,t.attrName,t.value));case"SET_MODULE_LOOP_DATA":return j(),e.setIn(["loopData"],((e,t,n)=>(e.getIn(["loopData"])||e.set("loopData",{}).getIn(["loopData"])).set(t,{queryItems:n.queryItems}))(e,t.id,t.loopData));default:return e}var n,r},rr=(e,t)=>t?.path&&!(0,g.isEmpty)(t.path)?e.getIn(t?.path):e,or={};window?.DiviEditPostData?.debug?.storeStateModal&&(or.debugState=rr);const ir=n=>{if((0,a.select)("divi/edit-post"))return;(0,a.select)("divi/module")||(0,u.registerModuleStore)(),(0,a.select)("divi/module-library")||(0,d.registerModuleLibraryStore)(),(0,a.select)("divi/history")||(0,l.registerHistoryStore)();const r=n||i()(((e="postContent")=>{const t=(0,a.select)("divi/serialized-post").getState([e,"content"]),n=H(t);return{content:n,specialtySection:!1,layouts:{postContent:{removedModules:{}}},presets:{module:(0,Q.populateUsedPresets)(n),group:(0,Q.populateUsedGroupPresets)(n)}}})("postContent")),o=(0,a.registerStore)("divi/edit-post",{actions:e,reducer:nr,selectors:{...t,...or},initialState:r});(0,s.applyMiddlewares)(o,jt),(0,s.applyEffects)(o,Gt),ne({type:"SET_LAYOUT_STATE",location:"content",layoutState:r?.getIn(["content"])},o)}}(),(window.divi=window.divi||{}).editPost=r}();